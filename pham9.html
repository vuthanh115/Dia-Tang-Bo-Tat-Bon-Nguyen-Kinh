<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kinh ƒê·ªãa T·∫°ng - Ph·∫©m 9 (Audio Pinyin)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#1c1917',      /* Stone 900 */
                            card: '#292524',    /* Stone 800 */
                            border: '#44403c',  /* Stone 700 */
                            text: '#e7e5e4',    /* Stone 200 */
                            muted: '#a8a29e'    /* Stone 400 */
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&family=Noto+Sans:wght@300;400;500;600&family=Be+Vietnam+Pro:wght@400;500;600&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500;700&display=swap'); /* Font for Chinese */
        
        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #1c1917; /* Stone 900 - Dark Mode Default */
            color: #e7e5e4; /* Stone 200 */
        }
        
        h1, h2, h3, .serif {
            font-family: 'Noto Serif', serif;
        }

        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 300px; 
            max-height: 400px; 
        }

        /* Custom scrollbar - Dark version */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #292524;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background-color: #57534e;
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background-color: #78716c;
        }

        /* Active line - Dark version */
        .active-line {
            background-color: #451a03; /* Amber 950/Darker */
            border-left: 4px solid #f59e0b; /* Amber 500 */
            padding-left: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .transcript-item {
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
            border-bottom: 1px solid #44403c; /* Stone 700 */
            position: relative; /* For absolute positioning of audio button */
        }
        .transcript-item:hover {
            background-color: #292524; /* Stone 800 */
            border-left-color: #57534e;
        }

        /* Typography for multi-lingual display - DARK MODE COLORS */
        .cn-text {
            font-family: "Noto Serif SC", "SimSun", serif;
            font-size: 1.6em;
            color: #e7e5e4; /* Stone 200 - White-ish */
            margin-bottom: 0.2rem;
            line-height: 1.4;
            font-weight: 500;
        }
        .pinyin-text {
            color: #a8a29e; /* Stone 400 - Light Gray */
            font-size: 0.85em;
            margin-bottom: 0.35rem;
            font-family: 'Noto Sans', sans-serif;
            font-style: italic;
        }
        .viet-han-text {
            color: #fbbf24; /* Amber 400 - Bright Amber */
            font-size: 1.05em;
            font-weight: 700;
            line-height: 1.5;
            font-family: 'Noto Serif', serif;
            margin-bottom: 0.2rem;
        }
        .viet-trans-text {
            color: #86efac; /* Green 300 - Light Green */
            font-size: 1.05em;
            font-family: 'Be Vietnam Pro', sans-serif;
            line-height: 1.6;
            margin-bottom: 0.2rem;
            font-weight: 500;
        }
        .en-text {
            color: #78716c; /* Stone 500 - Dim Gray */
            font-size: 0.9em;
            font-style: italic;
            font-family: 'Noto Serif', serif;
            line-height: 1.4;
            opacity: 0.8;
        }

        /* Highlight classes for Tam Thien Tu analysis - Dark Mode Adapted */
        .char-basic {
            color: #14532d; /* Green 900 */
            background-color: #86efac; /* Green 300 */
            border-radius: 2px;
            padding: 0 2px;
            font-weight: bold;
        }
        .char-advanced {
            color: #f59e0b; /* Amber 500 */
            border-bottom: 1px dotted #f59e0b;
        }
        
        .analysis-mode-active .cn-text {
            line-height: 1.8;
        }
        
        /* Audio Button Pulse Animation */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(245, 158, 11, 0); }
            100% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); }
        }
        .speaking-active .audio-btn {
            color: #fbbf24;
            animation: pulse-ring 2s infinite;
        }

        /* Utility for input placeholder in dark mode */
        ::placeholder {
            color: #78716c;
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Navigation / Header -->
    <header class="bg-stone-900 shadow-md border-b border-stone-700 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <!-- N√öT QUAY L·∫†I TRANG CH·ª¶ -->
                <a href="index.html" class="flex items-center gap-3 group decoration-0" title="Quay v·ªÅ M·ª•c L·ª•c">
                    <div class="w-9 h-9 rounded-full bg-amber-700 flex items-center justify-center text-white font-bold serif shadow-sm shadow-amber-900 group-hover:bg-amber-600 transition-colors">
                        <span class="block group-hover:hidden">ƒê</span>
                        <span class="hidden group-hover:block">‚¨Ö</span>
                    </div>
                    <div>
                        <h1 class="text-lg md:text-xl font-bold text-stone-200 tracking-wide serif leading-tight group-hover:text-amber-500 transition-colors">Kinh ƒê·ªãa T·∫°ng</h1>
                        <p class="text-xs text-stone-500 font-medium">Ph·∫©m 9: X∆∞ng Danh Hi·ªáu Ch∆∞ Ph·∫≠t</p>
                    </div>
                </a>
            </div>
            
            <nav class="hidden md:flex gap-6 text-sm font-medium text-stone-400">
                <!-- MENU M·ª§C L·ª§C -->
                <a href="index.html" class="hover:text-amber-500 transition-colors flex items-center gap-1 text-amber-500/80">
                    <span>üìö</span> M·ª•c L·ª•c
                </a>
                <a href="#dashboard" class="hover:text-amber-500 transition-colors">T·ªïng Quan</a>
                <a href="#hanzi-analysis" class="hover:text-amber-500 transition-colors">Ph√¢n T√≠ch H√°n T·ª±</a>
                <a href="#transcript" class="hover:text-amber-500 transition-colors">N·ªôi Dung</a>
            </nav>
            
            <div class="flex gap-2">
                <button id="tttToggle" class="px-3 py-2 bg-stone-800 hover:bg-stone-700 text-green-400 rounded-md text-sm font-medium transition-colors border border-stone-700" title="T√¥ m√†u ch·ªØ c√≥ trong Tam Thi√™n T·ª±">
                    üåø Soi Tam Thi√™n T·ª±
                </button>
                <button id="modeToggle" class="px-3 py-2 bg-stone-800 hover:bg-stone-700 text-stone-300 rounded-md text-sm font-medium transition-colors border border-stone-700">
                    ‚òÄÔ∏è Ch·∫ø ƒë·ªô S√°ng
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 space-y-10 max-w-6xl">

        <!-- Hanzi Analysis Dashboard -->
        <section id="hanzi-analysis" class="bg-stone-800 p-6 md:p-8 rounded-2xl shadow-lg border border-stone-700">
            <div class="mb-6 pb-4 border-b border-stone-700 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <h3 class="text-xl font-bold text-stone-200 flex items-center gap-2 serif">
                        <span class="text-green-500">üìñ</span> Ph√¢n T√≠ch T·ª´ V·ª±ng (Tam Thi√™n T·ª±)
                    </h3>
                    <p class="text-sm text-stone-400 mt-1">
                        ƒê·ªëi chi·∫øu ch·ªØ H√°n trong Ph·∫©m 9 v·ªõi danh s√°ch 3.000 ch·ªØ cƒÉn b·∫£n.
                    </p>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold text-stone-200" id="uniqueCharCount">0</div>
                    <div class="text-xs text-stone-500">T·ªïng ch·ªØ H√°n duy nh·∫•t (kh√¥ng l·∫∑p)</div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Chart -->
                <div class="col-span-1 h-64 chart-container flex items-center justify-center">
                    <canvas id="vocabChart"></canvas>
                </div>

                <!-- Details -->
                <div class="col-span-2 space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 bg-green-900/20 rounded-lg border border-green-800/50">
                            <div class="text-sm text-green-400 font-medium mb-1">Thu·ªôc Tam Thi√™n T·ª±</div>
                            <div class="text-3xl font-bold text-green-500" id="inTTTCount">0</div>
                            <div class="text-xs text-green-400/70 mt-1" id="inTTTPerc">0%</div>
                        </div>
                        <div class="p-4 bg-amber-900/20 rounded-lg border border-amber-800/50">
                            <div class="text-sm text-amber-400 font-medium mb-1">Ngo√†i Tam Thi√™n T·ª±</div>
                            <div class="text-3xl font-bold text-amber-500" id="outTTTCount">0</div>
                            <div class="text-xs text-amber-400/70 mt-1" id="outTTTPerc">0%</div>
                        </div>
                    </div>
                    
                    <div class="bg-stone-900/50 p-4 rounded-lg text-sm text-stone-400 border border-stone-700">
                        <p class="mb-2 font-semibold text-stone-300">Nh·∫≠n x√©t:</p>
                        <p id="analysisComment">ƒêang ph√¢n t√≠ch d·ªØ li·ªáu...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Transcript & Interactive Player -->
        <section id="transcript" class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            
            <!-- Controls Column (Left) -->
            <div class="lg:col-span-4 bg-stone-800 p-6 rounded-xl shadow-lg border border-stone-700 sticky top-24">
                <h3 class="text-lg font-bold text-stone-200 mb-4 serif border-b pb-2 border-stone-700">B·∫£ng ƒêi·ªÅu Khi·ªÉn</h3>
                
                <div class="space-y-6">
                    <!-- Simulation Controls -->
                    <div class="p-4 bg-amber-900/20 rounded-lg border border-amber-800/30">
                        <p class="text-sm text-amber-500 mb-3 font-semibold flex items-center gap-2">
                            üéß M√¥ ph·ªèng t·ª•ng
                        </p>
                        <div class="flex gap-2">
                            <button id="btnPlay" class="flex-1 bg-amber-700 hover:bg-amber-600 text-white py-2.5 px-4 rounded shadow-sm text-sm font-medium transition-colors flex justify-center items-center gap-2">
                                <span>‚ñ∂</span> B·∫Øt ƒë·∫ßu
                            </button>
                            <button id="btnPause" class="flex-1 bg-stone-700 border border-stone-600 hover:bg-stone-600 text-amber-400 py-2.5 px-4 rounded shadow-sm text-sm font-medium transition-colors hidden">
                                <span>‚è∏</span> T·∫°m d·ª´ng
                            </button>
                            <button id="btnReset" class="px-3 bg-stone-700 border border-stone-600 hover:bg-stone-600 text-stone-300 rounded shadow-sm transition-colors" title="Quay l·∫°i t·ª´ ƒë·∫ßu">
                                ‚Ü∫
                            </button>
                        </div>
                        <div class="flex justify-between items-center mt-3 px-1">
                            <span class="text-xs text-amber-500 font-mono" id="currentTimeDisplay">00:00</span>
                            <span class="text-xs text-amber-500/50">T·ª± ƒë·ªông cu·ªôn</span>
                        </div>
                        <div class="mt-3 flex items-center gap-2">
                            <input type="checkbox" id="autoRead" class="rounded border-stone-600 text-amber-600 focus:ring-amber-500 bg-stone-900">
                            <label for="autoRead" class="text-xs text-stone-400 cursor-pointer select-none">T·ª± ƒë·ªông ƒë·ªçc Pinyin khi ch·∫°y</label>
                        </div>
                    </div>

                    <!-- Search/Filter -->
                    <div>
                        <label class="block text-xs font-semibold uppercase text-stone-500 mb-1.5 tracking-wide">T√¨m ki·∫øm</label>
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm (Vi·ªát, Anh, H√°n)..." 
                                   class="w-full pl-9 pr-3 py-2 bg-stone-900 border border-stone-700 text-stone-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm shadow-sm placeholder-stone-600">
                            <span class="absolute left-3 top-2.5 text-stone-500">üîç</span>
                        </div>
                    </div>

                    <!-- Jump To -->
                    <div>
                        <label class="block text-xs font-semibold uppercase text-stone-500 mb-1.5 tracking-wide">Chuy·ªÉn nhanh</label>
                        <select id="jumpSelect" class="w-full px-3 py-2 border border-stone-700 rounded-lg bg-stone-900 text-stone-300 text-sm focus:ring-amber-500 focus:border-amber-500 shadow-sm cursor-pointer hover:bg-stone-950">
                            <option value="0">00:00 - Kh·ªüi ƒë·∫ßu</option>
                            <!-- Options populated by JS -->
                        </select>
                    </div>

                    <!-- Legend for Analysis -->
                    <div id="analysisLegend" class="hidden p-4 bg-stone-900/50 rounded-lg border border-stone-700">
                        <p class="text-xs font-bold text-stone-500 uppercase mb-2">Ch√∫ gi·∫£i m√†u s·∫Øc</p>
                        <div class="flex flex-col gap-2 text-sm">
                            <div class="flex items-center gap-2">
                                <span class="px-1 bg-green-300 text-green-900 rounded font-bold font-serif">Â§©</span>
                                <span class="text-stone-400">C√≥ trong Tam Thi√™n T·ª±</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="px-1 text-amber-500 font-serif border-b border-dotted border-amber-500">Âøâ</span>
                                <span class="text-stone-400">Kh√¥ng c√≥ trong danh s√°ch</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- List Column (Right) -->
            <div class="lg:col-span-8">
                <div class="bg-stone-800 rounded-xl shadow-lg border border-stone-700 overflow-hidden flex flex-col h-[700px]">
                    <div class="p-4 border-b border-stone-700 bg-stone-800/80 flex flex-wrap gap-2 justify-between items-center backdrop-blur-sm sticky top-0 z-10">
                        <div class="flex items-center gap-2">
                            <span class="font-bold text-stone-300 serif">N·ªôi Dung Kinh VƒÉn</span>
                            <span class="px-2 py-0.5 text-xs bg-stone-700 text-stone-300 rounded border border-stone-600">H√°n</span>
                            <span class="px-2 py-0.5 text-xs bg-amber-900/40 text-amber-400 rounded border border-amber-800/50">√Çm</span>
                            <span class="px-2 py-0.5 text-xs bg-green-900/40 text-green-400 rounded border border-green-800/50">Nghƒ©a</span>
                            <span class="px-2 py-0.5 text-xs bg-stone-700/50 text-stone-500 rounded border border-stone-700">Anh</span>
                        </div>
                        <span class="text-xs text-stone-400 bg-stone-700 px-2.5 py-1 rounded-full font-medium" id="visibleCount">0 c√¢u</span>
                    </div>
                    
                    <div id="transcriptContainer" class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1 relative scroll-smooth bg-stone-900">
                        <!-- Content populated by JS -->
                        <div class="flex flex-col items-center justify-center h-full text-stone-600 gap-2">
                            <svg class="animate-spin h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span>ƒêang t·∫£i d·ªØ li·ªáu...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-stone-950 text-stone-500 py-10 mt-12 border-t border-stone-800">
        <div class="container mx-auto px-4 text-center">
            <div class="serif text-xl text-stone-400 mb-3">Nam M√¥ ƒê·∫°i Nguy·ªán ƒê·ªãa T·∫°ng V∆∞∆°ng B·ªì T√°t</div>
            <p class="text-sm opacity-60">D·ªØ li·ªáu ƒë∆∞·ª£c tr√≠ch xu·∫•t t·ª´ ngu·ªìn: A Di ƒê√† Ph·∫≠t TV (YouTube)</p>
            <p class="text-xs opacity-40 mt-2">Ph√¢n t√≠ch d·ª±a tr√™n danh s√°ch Tam Thi√™n T·ª± (~3000 ch·ªØ cƒÉn b·∫£n)</p>
        </div>
    </footer>

    <!-- RAW DATA STORAGE -->
    <script>
        // Updated Data for Chapter 9
        const rawSubtitleData = `
[00:00:00] Âú∞ËóèËè©Ëê®Êú¨ÊÑøÁªè Áß∞‰ΩõÂêçÂè∑ÂìÅÁ¨¨‰πù | d√¨ z√†ng p√∫ s√† bƒõn yu√†n jƒ´ng chƒìng f√≥ m√≠ng h√†o p«ên d√¨ ji«î | ƒê·ªãa T·∫°ng B·ªì T√°t B·ªïn Nguy·ªán Kinh - X∆∞ng Ph·∫≠t Danh Hi·ªáu Ph·∫©m ƒê·ªá C·ª≠u | Sutra of the Past Vows of Earth Store Bodhisattva - Chapter 9: The Recitation of the Names of Buddhas | Kinh ƒê·ªãa T·∫°ng B·ªì T√°t B·ªïn Nguy·ªán - Ph·∫©m th·ª© ch√≠n: X∆∞ng Danh Hi·ªáu Ch∆∞ Ph·∫≠t.
[00:00:10] Â∞îÊó∂Âú∞ËóèËè©Ëê®Êë©ËØÉËê®ÁôΩ‰ΩõË®Ä„ÄÇ | ƒõr sh√≠ d√¨ z√†ng p√∫ s√† m√≥ hƒì s√† b√°i f√≥ y√°n „ÄÇ | Nhƒ© th·ªùi ƒê·ªãa T·∫°ng B·ªì T√°t Ma Ha T√°t b·∫°ch Ph·∫≠t ng√¥n. | At that time, Earth Store Bodhisattva Mahasattva said to the Buddha: | L√∫c ƒë√≥, Ng√†i ƒê·ªãa T·∫°ng B·ªì T√°t Ma Ha T√°t b·∫°ch c√πng ƒë·ª©c Ph·∫≠t r·∫±ng:
[00:00:15] ‰∏ñÂ∞ä„ÄÇÊàë‰ªä‰∏∫Êú™Êù•‰ºóÁîüÊºîÂà©Áõä‰∫ã„ÄÇ‰∫éÁîüÊ≠ª‰∏≠„ÄÇÂæóÂ§ßÂà©Áõä„ÄÇ | sh√¨ z≈´n „ÄÇ w«í jƒ´n w√®i w√®i l√°i zh√≤ng shƒìng y«én l√¨ y√¨ sh√¨ „ÄÇ y√∫ shƒìng s«ê zh≈çng „ÄÇ d√© d√† l√¨ y√¨ „ÄÇ | Th·∫ø T√¥n. Ng√£ kim v·ªã v·ªã lai ch√∫ng sanh di·ªÖn l·ª£i √≠ch s·ª±. ∆Ø sanh t·ª≠ trung. ƒê·∫Øc ƒë·∫°i l·ª£i √≠ch. | "World Honored One, I shall now manifest for the sake of living beings of the future a way to benefit them, so that they may obtain great benefits in the midst of birth and death." | "B·∫°ch Th·∫ø T√¥n! Nay con v√¨ ch√∫ng sanh trong ƒë·ªùi sau m√† di·ªÖn n√≥i s·ª± l·ª£i √≠ch, l√†m cho trong v√≤ng sanh t·ª≠ ƒë·∫∑ng nhi·ªÅu l·ª£i √≠ch l·ªõn."
[00:00:23] ÂîØÊÑø‰∏ñÂ∞ä„ÄÇÂê¨ÊàëËØ¥‰πã„ÄÇ | w√©i yu√†n sh√¨ z≈´n „ÄÇ tƒ´ng w«í shu≈ç zhƒ´ „ÄÇ | Duy nguy·ªán Th·∫ø T√¥n. Th√≠nh ng√£ thuy·∫øt chi. | "I only pray the World Honored One will hear me speak of it." | "C√∫i xin ƒê·ª©c Th·∫ø T√¥n cho ph√©p con n√≥i ƒë√≥."
[00:00:26] ‰ΩõÂëäÂú∞ËóèËè©Ëê®„ÄÇÊ±ù‰ªäÊ¨≤ÂÖ¥ÊÖàÊÇ≤„ÄÇÊïëÊãî‰∏ÄÂàáÁΩ™Ëã¶ÂÖ≠ÈÅì‰ºóÁîü„ÄÇÊºî‰∏çÊÄùËÆÆ‰∫ã„ÄÇ | f√≥ g√†o d√¨ z√†ng p√∫ s√† „ÄÇ r«î jƒ´n y√π xƒ´ng c√≠ bƒìi „ÄÇ ji√π b√° y√≠ qi√® zu√¨ k«î li√π d√†o zh√≤ng shƒìng „ÄÇ y«én b√π sƒ´ y√¨ sh√¨ „ÄÇ | Ph·∫≠t c√°o ƒê·ªãa T·∫°ng B·ªì T√°t. Nh·ªØ kim d·ª•c h∆∞ng t·ª´ bi. C·ª©u b·∫°t nh·∫•t thi·∫øt t·ªôi kh·ªï l·ª•c ƒë·∫°o ch√∫ng sanh. Di·ªÖn b·∫•t t∆∞ ngh·ªã s·ª±. | The Buddha told Earth Store Bodhisattva, "You now wish to give rise to compassion and rescue all suffering beings in the Six Paths by proclaiming the inconceivable matter." | ƒê·ª©c Ph·∫≠t b·∫£o Ng√†i ƒê·ªãa T·∫°ng B·ªì T√°t r·∫±ng: "Nay √¥ng mu·ªën kh·ªüi l√≤ng t·ª´ bi c·ª©u v·ªõt t·∫•t c·∫£ ch√∫ng sanh m·∫Øc t·ªôi kh·ªï trong s√°u ƒë∆∞·ªùng, m√† di·ªÖn n√≥i vi·ªác kh√¥ng th·ªÉ nghƒ© b√†n."
[00:00:36] ‰ªäÊ≠£ÊòØÊó∂„ÄÇÂîØÂΩìÈÄüËØ¥„ÄÇÂêæÂç≥Ê∂ÖÊßÉ„ÄÇ‰ΩøÊ±ùÊó©ÊØïÊòØÊÑø„ÄÇÂêæ‰∫¶Êó†ÂøßÁé∞Âú®Êú™Êù•‰∏ÄÂàá‰ºóÁîü„ÄÇ | jƒ´n zh√®ng sh√¨ sh√≠ „ÄÇ w√©i dƒÅng s√π shu≈ç „ÄÇ w√∫ j√≠ ni√® p√°n „ÄÇ sh«ê r«î z«éo b√¨ sh√¨ yu√†n „ÄÇ w√∫ y√¨ w√∫ y≈çu xi√†n z√†i w√®i l√°i y√≠ qi√® zh√≤ng shƒìng „ÄÇ | Kim ch√°nh th·ªã th·ªùi. Duy ƒë∆∞∆°ng t·ªëc thuy·∫øt. Ng√¥ t·ª©c Ni·∫øt B√†n. S·ª≠ nh·ªØ t·∫£o t·∫•t th·ªã nguy·ªán. Ng√¥ di·ªác v√¥ ∆∞u hi·ªán t·∫°i v·ªã lai nh·∫•t thi·∫øt ch√∫ng sanh. | "Now is exactly the time. You should speak quickly. I am about to enter Nirvana. I wish you to fulfill this vow early so that I will have no further worry about all living beings of the present and future." | "Nay ch√≠nh l√† l√∫c, √¥ng n√™n n√≥i ngay ƒëi. Ta s·∫Øp nh·∫≠p Ni·∫øt B√†n, mong √¥ng s·ªõm ho√†n th√†nh t√¢m nguy·ªán ƒë√≥, ƒë·ªÉ Ta kh√¥ng c√≤n ph·∫£i lo ng·∫°i g√¨ ƒë·∫øn ch√∫ng sanh ·ªü hi·ªán t·∫°i v√† v·ªã lai n·ªØa."
[00:00:48] Âú∞ËóèËè©Ëê®ÁôΩ‰ΩõË®Ä„ÄÇ‰∏ñÂ∞ä„ÄÇËøáÂéªÊó†ÈáèÈòøÂÉßÁ•áÂä´„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇ | d√¨ z√†ng p√∫ s√† b√°i f√≥ y√°n „ÄÇ sh√¨ z≈´n „ÄÇ gu√≤ q√π w√∫ li√†ng ƒÅ sƒìng q√≠ ji√© „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ | ƒê·ªãa T·∫°ng B·ªì T√°t b·∫°ch Ph·∫≠t ng√¥n. Th·∫ø T√¥n. Qu√° kh·ª© v√¥ l∆∞·ª£ng a tƒÉng k·ª≥ ki·∫øp. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. | Earth Store Bodhisattva said to the Buddha, "World Honored One, in the past, immeasurable Asankhyeya aeons ago, a Buddha appeared in the world." | Ng√†i ƒê·ªãa T·∫°ng B·ªì T√°t b·∫°ch c√πng ƒê·ª©c Ph·∫≠t r·∫±ng: "B·∫°ch Th·∫ø T√¥n! V√¥ l∆∞·ª£ng v√¥ s·ªë ki·∫øp v·ªÅ thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi..."
[00:00:57] Âè∑Êó†ËæπË∫´Â¶ÇÊù•„ÄÇËã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇÊöÇÁîüÊÅ≠Êï¨„ÄÇ | h√†o w√∫ biƒÅn shƒìn r√∫ l√°i „ÄÇ ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ z√†n shƒìng g≈çng j√¨ng „ÄÇ | Hi·ªáu V√¥ Bi√™n Th√¢n Nh∆∞ Lai. Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. T·∫°m sanh cung k√≠nh. | "His name was Boundless Body Tathagata. If men or women hear this Buddha's name and have a momentary thought of respect..." | "...hi·ªáu l√† V√¥ Bi√™n Th√¢n Nh∆∞ Lai. Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y m√† t·∫°m sanh l√≤ng cung k√≠nh..."
[00:01:05] Âç≥ÂæóË∂ÖË∂äÂõõÂçÅÂä´ÁîüÊ≠ªÈáçÁΩ™„ÄÇ‰ΩïÂÜµÂ°ëÁîªÂΩ¢ÂÉè„ÄÇ‰æõÂÖªËµûÂèπ„ÄÇ | j√≠ d√© chƒÅo yu√® s√¨ sh√≠ ji√© shƒìng s«ê zh√≤ng zu√¨ „ÄÇ h√© ku√†ng s√π hu√† x√≠ng xi√†ng „ÄÇ g√≤ng y√†ng z√†n t√†n „ÄÇ | T·ª©c ƒë·∫Øc si√™u vi·ªát t·ª© th·∫≠p ki·∫øp sanh t·ª≠ tr·ªçng t·ªôi. H√† hu·ªëng t·ªë h·ªça h√¨nh t∆∞·ª£ng. C√∫ng d∆∞·ªùng t√°n th√°n. | "...they will immediately transcend the heavy offenses of forty aeons of birth and death. How much more so if they sculpt or paint his image, or make offerings and praise him!" | "...th·ªùi li·ªÅn ƒë∆∞·ª£c qua kh·ªèi t·ªôi n·∫∑ng sanh t·ª≠ trong b·ªën m∆∞∆°i ki·∫øp. Hu·ªëng l√† v·∫Ω ƒë·∫Øp h√¨nh t∆∞·ª£ng c√∫ng d∆∞·ªùng khen ng·ª£i!"
[00:01:13] ÂÖ∂‰∫∫Ëé∑Á¶è„ÄÇÊó†ÈáèÊó†Ëæπ„ÄÇ | q√≠ r√©n hu√≤ f√∫ „ÄÇ w√∫ li√†ng w√∫ biƒÅn „ÄÇ | K·ª≥ nh√¢n ho·∫°ch ph∆∞·ªõc. V√¥ l∆∞·ª£ng v√¥ bi√™n. | "The merit they obtain will be limitless and boundless." | "Ng∆∞·ªùi n√†y ƒë∆∞·ª£c v√¥ l∆∞·ª£ng v√¥ bi√™n ph∆∞·ªõc b√°o."
[00:01:16] Âèà‰∫éËøáÂéªÊÅíÊ≤≥Ê≤ôÂä´„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑ÂÆùÊÄßÂ¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π h√©ng h√© shƒÅ ji√© „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o b«éo x√¨ng r√∫ l√°i „ÄÇ | H·ª±u ∆∞ qu√° kh·ª© H·∫±ng H√† sa ki·∫øp. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu B·∫£o T√°nh Nh∆∞ Lai. | "Again, in the past, as many aeons ago as there are sands in the Ganges River, a Buddha appeared in the world named Jewel Nature Tathagata." | "L·∫°i h·∫±ng h√† sa ki·∫øp v·ªÅ thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† B·∫£o T√°nh Nh∆∞ Lai."
[00:01:23] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇ‰∏ÄÂºπÊåáÈ°∑„ÄÇÂèëÂøÉÂΩí‰æù„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ yƒ´ t√°n zh«ê q«êng „ÄÇ fƒÅ xƒ´n guƒ´ yƒ´ „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. Nh·∫•t ƒë√†n ch·ªâ kho·∫£nh. Ph√°t t√¢m quy y. | "If men or women hear this Buddha's name and, for the space of a finger-snap, resolve to take refuge..." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, li·ªÅn trong kho·∫£ng kh·∫£y m√≥ng tay ph√°t t√¢m quy y..."
[00:01:30] ÊòØ‰∫∫‰∫éÊó†‰∏äÈÅì„ÄÇÊ∞∏‰∏çÈÄÄËΩ¨„ÄÇ | sh√¨ r√©n y√∫ w√∫ sh√†ng d√†o „ÄÇ y«íng b√π tu√¨ zhu«én „ÄÇ | Th·ªã nh√¢n ∆∞ V√¥ Th∆∞·ª£ng ƒê·∫°o. Vƒ©nh b·∫•t th·ªëi chuy·ªÉn. | "...such people will never retreat from the Unsurpassed Way." | "...th·ªùi ng∆∞·ªùi ƒë√≥ n∆°i ƒë·∫°o V√¥ Th∆∞·ª£ng Ch√°nh Gi√°c kh√¥ng c√≤n th·ªëi chuy·ªÉn."
[00:01:34] Âèà‰∫éËøáÂéª„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑Ê≥¢Â§¥Êë©ËÉúÂ¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o b≈ç t√≥u m√≥ sh√®ng r√∫ l√°i „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu Ba ƒê·∫ßu Ma Th·∫Øng Nh∆∞ Lai. | "Again, in the past, a Buddha appeared in the world named Padma Victory Tathagata." | "L·∫°i thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† Ba ƒê·∫ßu Ma Th·∫Øng Nh∆∞ Lai."
[00:01:40] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇÂéÜ‰∫éËÄ≥Ê†π„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ l√¨ y√∫ ƒõr gƒìn „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. L·ªãch ∆∞ nhƒ© cƒÉn. | "If men or women hear this Buddha's name, and it passes through their ears..." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y tho·∫£ng qua l·ªó tai..."
[00:01:45] ÊòØ‰∫∫ÂΩìÂæóÂçÉËøîÁîü‰∫éÂÖ≠Ê¨≤Â§©‰∏≠„ÄÇ‰ΩïÂÜµÂøóÂøÉÁß∞Âøµ„ÄÇ | sh√¨ r√©n dƒÅng d√© qiƒÅn f«én shƒìng y√∫ li√π y√π tiƒÅn zh≈çng „ÄÇ h√© ku√†ng zh√¨ xƒ´n chƒìng ni√†n „ÄÇ | Th·ªã nh√¢n ƒë∆∞∆°ng ƒë·∫Øc thi√™n ph·∫£n sanh ∆∞ L·ª•c D·ª•c Thi√™n trung. H√† hu·ªëng ch√≠ t√¢m x∆∞ng ni·ªám. | "...such people will be reborn one thousand times in the Six Desire Heavens. How much more so if they sincerely recite it!" | "...ng∆∞·ªùi ƒë√≥ s·∫Ω ƒë∆∞·ª£c m·ªôt ngh√¨n l·∫ßn sanh l√™n s√°u c√µi tr·ªùi D·ª•c, hu·ªëng chi l√† ch√≠ t√¢m x∆∞ng ni·ªám."
[00:01:52] Âèà‰∫éËøáÂéª„ÄÇ‰∏çÂèØËØ¥‰∏çÂèØËØ¥ÈòøÂÉßÁ•áÂä´„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑ÁãÆÂ≠êÂêºÂ¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ b√π kƒõ shu≈ç b√π kƒõ shu≈ç ƒÅ sƒìng q√≠ ji√© „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. B·∫•t kh·∫£ thuy·∫øt b·∫•t kh·∫£ thuy·∫øt a tƒÉng k·ª≥ ki·∫øp. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu S∆∞ T·ª≠ H·ªëng Nh∆∞ Lai. | "Again, in the past, inexpressible inexpressible Asankhyeya aeons ago, a Buddha appeared in the world named Lion Roar Tathagata." | "L·∫°i b·∫•t kh·∫£ thuy·∫øt b·∫•t kh·∫£ thuy·∫øt a tƒÉng k·ª≥ ki·∫øp v·ªÅ thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† S∆∞ T·ª≠ H·ªëng Nh∆∞ Lai."
[00:02:01] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇ‰∏ÄÂøµÂΩí‰æù„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ yƒ´ ni√†n guƒ´ yƒ´ „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. Nh·∫•t ni·ªám quy y. | "If men or women hear this Buddha's name and in a single thought take refuge..." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y m√† m·ªôt ni·ªám quy y..."
[00:02:07] ÊòØ‰∫∫ÂæóÈÅáÊó†ÈáèËØ∏‰Ωõ„ÄÇÊë©È°∂ÊéàËÆ∞„ÄÇ | sh√¨ r√©n d√© y√π w√∫ li√†ng zh≈´ f√≥ „ÄÇ m√≥ d«êng sh√≤u j√¨ „ÄÇ | Th·ªã nh√¢n ƒë·∫Øc ng·ªô v√¥ l∆∞·ª£ng ch∆∞ Ph·∫≠t. Ma ƒë·∫£nh th·ªç k√Ω. | "...such people will encounter immeasurable Buddhas who will rub their crowns and bestow predictions (of Enlightenment)." | "...ng∆∞·ªùi ·∫•y s·∫Ω ƒë∆∞·ª£c g·∫∑p v√¥ l∆∞·ª£ng c√°c ƒë·ª©c Ph·∫≠t xoa ƒë·∫£nh th·ªç k√Ω cho."
[00:02:12] Âèà‰∫éËøáÂéª„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑ÊãòÁïôÂ≠ô‰Ωõ„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o j≈´ li√∫ s≈´n f√≥ „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu C√¢u L∆∞u T√¥n Ph·∫≠t. | "Again, in the past, a Buddha appeared in the world named Krakucchanda Buddha." | "L·∫°i thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† C√¢u L∆∞u T√¥n Ph·∫≠t."
[00:02:17] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇÂøóÂøÉÁûªÁ§º„ÄÇÊàñÂ§çËµûÂèπ„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ zh√¨ xƒ´n zhƒÅn l«ê „ÄÇ hu√≤ f√π z√†n t√†n „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. Ch√≠ t√¢m chi√™m l·ªÖ. Ho·∫∑c ph·ª•c t√°n th√°n. | "If men or women hear this Buddha's name and sincerely gaze at, bow to, or praise him..." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, ch√≠ t√¢m chi√™m ng∆∞·ª°ng l·ªÖ b√°i, ho·∫∑c l·∫°i t√°n th√°n..."
[00:02:24] ÊòØ‰∫∫‰∫éË¥§Âä´ÂçÉ‰Ωõ‰ºö‰∏≠„ÄÇ‰∏∫Â§ßÊ¢µÁéã„ÄÇÂæóÊéà‰∏äËÆ∞„ÄÇ | sh√¨ r√©n y√∫ xi√°n ji√© qiƒÅn f√≥ hu√¨ zh≈çng „ÄÇ w√©i d√† f√†n w√°ng „ÄÇ d√© sh√≤u sh√†ng j√¨ „ÄÇ | Th·ªã nh√¢n ∆∞ Hi·ªÅn Ki·∫øp thi√™n Ph·∫≠t h·ªôi trung. Vi ƒê·∫°i Ph·∫°m V∆∞∆°ng. ƒê·∫Øc th·ªç th∆∞·ª£ng k√Ω. | "...such people will become Great Brahma Kings in the assembly of the Thousand Buddhas of the Worthy Kalpa and will receive superior predictions." | "...ng∆∞·ªùi ·∫•y ·ªü trong ph√°p h·ªôi c·ªßa m·ªôt ngh√¨n ƒë·ª©c Ph·∫≠t trong Hi·ªÅn Ki·∫øp l√†m v·ªã ƒê·∫°i Ph·∫°m V∆∞∆°ng, ƒë·∫∑ng Ph·∫≠t th·ªç k√Ω ƒë·∫°o qu·∫£ V√¥ Th∆∞·ª£ng."
[00:02:32] Âèà‰∫éËøáÂéª„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑ÊØóÂ©ÜÂ∞∏‰Ωõ„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o p√≠ p√≥ shƒ´ f√≥ „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu T·ª≥ B√† Thi Ph·∫≠t. | "Again, in the past, a Buddha appeared in the world named Vipasyin Buddha." | "L·∫°i thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† T·ª≥ B√† Thi Ph·∫≠t."
[00:02:37] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇÊ∞∏‰∏çÂ†ïÊÅ∂ÈÅì„ÄÇÂ∏∏Áîü‰∫∫Â§©„ÄÇÂèóËÉúÂ¶ô‰πê„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ y«íng b√π du√≤ √® d√†o „ÄÇ ch√°ng shƒìng r√©n tiƒÅn „ÄÇ sh√≤u sh√®ng mi√†o l√® „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. Vƒ©nh b·∫•t ƒë·ªça √°c ƒë·∫°o. Th∆∞·ªùng sanh nh√¢n thi√™n. Th·ªç th·∫Øng di·ªáu l·∫°c. | "If men or women hear this Buddha's name, they will never fall into the Evil Paths and will always be born among humans and gods, receiving excellent and wonderful bliss." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, th·ªùi m√£i m√£i kh√¥ng c√≤n sa ƒë·ªça v√†o ch·ªën √°c ƒë·∫°o, th∆∞·ªùng ƒë∆∞·ª£c sanh v√†o c√µi ng∆∞·ªùi c√µi Tr·ªùi, h∆∞·ªüng s·ª± vui th√π th·∫Øng vi di·ªáu."
[00:02:47] Âèà‰∫éËøáÂéª„ÄÇÊó†ÈáèÊó†Êï∞ÊÅíÊ≤≥Ê≤ôÂä´„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑ÂÆùËÉúÂ¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ w√∫ li√†ng w√∫ sh√π h√©ng h√© shƒÅ ji√© „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o b«éo sh√®ng r√∫ l√°i „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. V√¥ l∆∞·ª£ng v√¥ s·ªë H·∫±ng H√† sa ki·∫øp. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu B·∫£o Th·∫Øng Nh∆∞ Lai. | "Again, in the past, immeasurable, incalculable Ganges sands of aeons ago, a Buddha appeared in the world named Jewel Victory Tathagata." | "L·∫°i v√¥ l∆∞·ª£ng v√¥ s·ªë h·∫±ng h√† sa ki·∫øp v·ªÅ thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† B·∫£o Th·∫Øng Nh∆∞ Lai."
[00:02:56] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇÊØïÁ´ü‰∏çÂ†ïÊÅ∂ÈÅì„ÄÇÂ∏∏Âú®Â§©‰∏ä„ÄÇÂèóËÉúÂ¶ô‰πê„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ b√¨ j√¨ng b√π du√≤ √® d√†o „ÄÇ ch√°ng z√†i tiƒÅn sh√†ng „ÄÇ sh√≤u sh√®ng mi√†o l√® „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. T·∫•t c√°nh b·∫•t ƒë·ªça √°c ƒë·∫°o. Th∆∞·ªùng t·∫°i thi√™n th∆∞·ª£ng. Th·ªç th·∫Øng di·ªáu l·∫°c. | "If men or women hear this Buddha's name, they will never fall into the Evil Paths and will always be in the heavens, receiving excellent and wonderful bliss." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, th·ªùi kh√¥ng c√≤n b·ªã ƒë·ªça v√†o √°c ƒë·∫°o, th∆∞·ªùng ·ªü t·∫°i c√µi Tr·ªùi h∆∞·ªüng s·ª± vui th√π th·∫Øng vi di·ªáu."
[00:03:05] Âèà‰∫éËøáÂéª„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑ÂÆùÁõ∏Â¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o b«éo xi√†ng r√∫ l√°i „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu B·∫£o T∆∞·ªõng Nh∆∞ Lai. | "Again, in the past, a Buddha appeared in the world named Jewel Appearance Tathagata." | "L·∫°i thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† B·∫£o T∆∞·ªõng Nh∆∞ Lai."
[00:03:10] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêç„ÄÇÁîüÊÅ≠Êï¨ÂøÉ„ÄÇÊòØ‰∫∫‰∏ç‰πÖÂæóÈòøÁΩóÊ±âÊûú„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng „ÄÇ shƒìng g≈çng j√¨ng xƒ´n „ÄÇ sh√¨ r√©n b√π ji«î d√© ƒÅ lu√≥ h√†n gu«í „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh. Sanh cung k√≠nh t√¢m. Th·ªã nh√¢n b·∫•t c·ª≠u ƒë·∫Øc A La H√°n qu·∫£. | "If men or women hear this Buddha's name and give rise to a respectful heart, such people will soon attain the fruit of Arhatship." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, sanh l√≤ng cung k√≠nh, ng∆∞·ªùi ·∫•y kh√¥ng bao l√¢u s·∫Ω ƒë·∫∑ng qu·∫£ A La H√°n."
[00:03:18] Âèà‰∫éËøáÂéª„ÄÇÊó†ÈáèÈòøÂÉßÁ•áÂä´„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑Ë¢àË£üÂπ¢Â¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ w√∫ li√†ng ƒÅ sƒìng q√≠ ji√© „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o jiƒÅ shƒÅ chu√°ng r√∫ l√°i „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. V√¥ l∆∞·ª£ng a tƒÉng k·ª≥ ki·∫øp. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu Ca Sa Tr√†ng Nh∆∞ Lai. | "Again, in the past, immeasurable Asankhyeya aeons ago, a Buddha appeared in the world named Kasaya Banner Tathagata." | "L·∫°i v√¥ l∆∞·ª£ng a tƒÉng k·ª≥ ki·∫øp v·ªÅ thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† Ca Sa Tr√†ng Nh∆∞ Lai."
[00:03:26] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêçËÄÖ„ÄÇË∂Ö‰∏ÄÁôæÂ§ßÂä´ÁîüÊ≠ª‰πãÁΩ™„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng zhƒõ „ÄÇ chƒÅo yƒ´ b«éi d√† ji√© shƒìng s«ê zhƒ´ zu√¨ „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh gi·∫£. Si√™u nh·∫•t b√°ch ƒë·∫°i ki·∫øp sanh t·ª≠ chi t·ªôi. | "If men or women hear this Buddha's name, they will transcend the offenses of one hundred great aeons of birth and death." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, th·ªùi si√™u tho√°t t·ªôi sanh t·ª≠ trong m·ªôt trƒÉm ƒë·∫°i ki·∫øp."
[00:03:34] Âèà‰∫éËøáÂéª„ÄÇÊúâ‰ΩõÂá∫‰∏ñ„ÄÇÂè∑Â§ßÈÄöÂ±±ÁéãÂ¶ÇÊù•„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ y«íu f√≥ ch≈´ sh√¨ „ÄÇ h√†o d√† t≈çng shƒÅn w√°ng r√∫ l√°i „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. H·ªØu Ph·∫≠t xu·∫•t th·∫ø. Hi·ªáu ƒê·∫°i Th√¥ng S∆°n V∆∞∆°ng Nh∆∞ Lai. | "Again, in the past, a Buddha appeared in the world named Great Penetration Mountain King Tathagata." | "L·∫°i thu·ªü qu√° kh·ª© c√≥ ƒë·ª©c Ph·∫≠t ra ƒë·ªùi hi·ªáu l√† ƒê·∫°i Th√¥ng S∆°n V∆∞∆°ng Nh∆∞ Lai."
[00:03:39] Ëã•ÊúâÁî∑Â≠êÂ•≥‰∫∫„ÄÇÈóªÊòØ‰ΩõÂêçËÄÖ„ÄÇÊòØ‰∫∫ÂæóÈÅáÊÅíÊ≤≥Ê≤ô‰Ωõ„ÄÇ | ru√≤ y«íu n√°n z«ê n«ö r√©n „ÄÇ w√©n sh√¨ f√≥ m√≠ng zhƒõ „ÄÇ sh√¨ r√©n d√© y√π h√©ng h√© shƒÅ f√≥ „ÄÇ | Nh∆∞·ª£c h·ªØu nam t·ª≠ n·ªØ nh√¢n. VƒÉn th·ªã Ph·∫≠t danh gi·∫£. Th·ªã nh√¢n ƒë·∫Øc ng·ªô H·∫±ng H√† sa Ph·∫≠t. | "If men or women hear this Buddha's name, such people will encounter Buddhas as numerous as Ganges sands..." | "Nh∆∞ c√≥ ng∆∞·ªùi nam ng∆∞·ªùi n·ªØ n√†o nghe ƒë·∫øn danh hi·ªáu c·ªßa ƒë·ª©c Ph·∫≠t n√†y, th·ªùi ng∆∞·ªùi ·∫•y ƒë·∫∑ng g·∫∑p h·∫±ng h√† sa s·ªë ch∆∞ Ph·∫≠t..."
[00:03:45] Âπø‰∏∫ËØ¥Ê≥ï„ÄÇÂøÖÊàêËè©Êèê„ÄÇ | gu«éng w√®i shu≈ç f«é „ÄÇ b√¨ ch√©ng p√∫ t√≠ „ÄÇ | Qu·∫£ng v·ªã thuy·∫øt ph√°p. T·∫•t th√†nh B·ªì ƒê·ªÅ. | "...who will speak Dharma for them extensively, and they will certainly realize Bodhi." | "...n√≥i ph√°p r·ªông l·ªõn cho, quy·∫øt ch·∫Øc th√†nh ƒë·∫°o B·ªì ƒê·ªÅ."
[00:03:49] Âèà‰∫éËøáÂéª„ÄÇÊúâÂáÄÊúà‰Ωõ„ÄÇÂ±±Áéã‰Ωõ„ÄÇÊô∫ËÉú‰Ωõ„ÄÇÂáÄÂêçÁéã‰Ωõ„ÄÇÊô∫ÊàêÂ∞±‰Ωõ„ÄÇÊó†‰∏ä‰Ωõ„ÄÇÂ¶ôÂ£∞‰Ωõ„ÄÇÊª°Êúà‰Ωõ„ÄÇÊúàÈù¢‰Ωõ„ÄÇÊúâÂ¶ÇÊòØÁ≠â‰∏çÂèØËØ¥‰Ωõ„ÄÇ | y√≤u y√∫ gu√≤ q√π „ÄÇ y«íu j√¨ng yu√® f√≥ „ÄÇ shƒÅn w√°ng f√≥ „ÄÇ zh√¨ sh√®ng f√≥ „ÄÇ j√¨ng m√≠ng w√°ng f√≥ „ÄÇ zh√¨ ch√©ng ji√π f√≥ „ÄÇ w√∫ sh√†ng f√≥ „ÄÇ mi√†o shƒìng f√≥ „ÄÇ m«én yu√® f√≥ „ÄÇ yu√® mi√†n f√≥ „ÄÇ y«íu r√∫ sh√¨ dƒõng b√π kƒõ shu≈ç f√≥ „ÄÇ | H·ª±u ∆∞ qu√° kh·ª©. H·ªØu T·ªãnh Nguy·ªát Ph·∫≠t. S∆°n V∆∞∆°ng Ph·∫≠t. Tr√≠ Th·∫Øng Ph·∫≠t. T·ªãnh Danh V∆∞∆°ng Ph·∫≠t. Tr√≠ Th√†nh T·ª±u Ph·∫≠t. V√¥ Th∆∞·ª£ng Ph·∫≠t. Di·ªáu Thanh Ph·∫≠t. M√£n Nguy·ªát Ph·∫≠t. Nguy·ªát Di·ªán Ph·∫≠t. H·ªØu nh∆∞ th·ªã ƒë·∫≥ng b·∫•t kh·∫£ thuy·∫øt Ph·∫≠t. | "Again, in the past, there were Pure Moon Buddha, Mountain King Buddha, Wisdom Victory Buddha, Pure Name King Buddha, Wisdom Accomplished Buddha, Unsurpassed Buddha, Wonderful Sound Buddha, Full Moon Buddha, Moon Face Buddha... There were indescribably many Buddhas like these." | "L·∫°i thu·ªü qu√° kh·ª©, c√≥ ƒë·ª©c Ph·∫≠t T·ªãnh Nguy·ªát, Ph·∫≠t S∆°n V∆∞∆°ng, Ph·∫≠t Tr√≠ Th·∫Øng, Ph·∫≠t T·ªãnh Danh V∆∞∆°ng, Ph·∫≠t Tr√≠ Th√†nh T·ª±u, Ph·∫≠t V√¥ Th∆∞·ª£ng, Ph·∫≠t Di·ªáu Thanh, Ph·∫≠t M√£n Nguy·ªát, Ph·∫≠t Nguy·ªát Di·ªán, c√≥ b·∫•t kh·∫£ thuy·∫øt ch∆∞ Ph·∫≠t nh∆∞ th·∫ø."
[00:04:13] ‰∏ñÂ∞ä„ÄÇÁé∞Âú®Êú™Êù•‰∏ÄÂàá‰ºóÁîü„ÄÇËã•Â§©Ëã•‰∫∫„ÄÇËã•Áî∑Ëã•Â•≥„ÄÇ | sh√¨ z≈´n „ÄÇ xi√†n z√†i w√®i l√°i y√≠ qi√® zh√≤ng shƒìng „ÄÇ ru√≤ tiƒÅn ru√≤ r√©n „ÄÇ ru√≤ n√°n ru√≤ n«ö „ÄÇ | Th·∫ø T√¥n. Hi·ªán t·∫°i v·ªã lai nh·∫•t thi·∫øt ch√∫ng sanh. Nh∆∞·ª£c Thi√™n nh∆∞·ª£c nh√¢n. Nh∆∞·ª£c nam nh∆∞·ª£c n·ªØ. | "World Honored One, living beings of the present and future, whether gods or humans, men or women..." | "B·∫°ch Th·∫ø T√¥n! T·∫•t c·∫£ ch√∫ng sanh ·ªü hi·ªán t·∫°i c√πng v·ªã lai, ho·∫∑c Tr·ªùi ho·∫∑c ng∆∞·ªùi, ho·∫∑c ng∆∞·ªùi nam ho·∫∑c ng∆∞·ªùi n·ªØ..."
[00:04:21] ‰ΩÜÂøµÂæó‰∏Ä‰ΩõÂêçÂè∑„ÄÇÂäüÂæ∑Êó†Èáè„ÄÇ‰ΩïÂÜµÂ§öÂêç„ÄÇ | d√†n ni√†n d√© yƒ´ f√≥ m√≠ng h√†o „ÄÇ g≈çng d√© w√∫ li√†ng „ÄÇ h√© ku√†ng du≈ç m√≠ng „ÄÇ | ƒê√£n ni·ªám ƒë·∫Øc nh·∫•t Ph·∫≠t danh hi·ªáu. C√¥ng ƒë·ª©c v√¥ l∆∞·ª£ng. H√† hu·ªëng ƒëa danh. | "...if they recite the name of only one Buddha, their merit will be measureless. How much more so if they recite many names!" | "...nh∆∞ ni·ªám ƒë∆∞·ª£c danh hi·ªáu c·ªßa m·ªôt ƒë·ª©c Ph·∫≠t th·ªùi c√¥ng ƒë·ª©c v√¥ l∆∞·ª£ng, hu·ªëng l√† ni·ªám ƒë∆∞·ª£c nhi·ªÅu danh hi·ªáu."
[00:04:27] ÊòØ‰ºóÁîüÁ≠â„ÄÇÁîüÊó∂Ê≠ªÊó∂„ÄÇËá™ÂæóÂ§ßÂà©„ÄÇÁªà‰∏çÂ†ïÊÅ∂ÈÅì„ÄÇ | sh√¨ zh√≤ng shƒìng dƒõng „ÄÇ shƒìng sh√≠ s«ê sh√≠ „ÄÇ z√¨ d√© d√† l√¨ „ÄÇ zh≈çng b√π du√≤ √® d√†o „ÄÇ | Th·ªã ch√∫ng sanh ƒë·∫≥ng. Sanh th·ªùi t·ª≠ th·ªùi. T·ª± ƒë·∫Øc ƒë·∫°i l·ª£i. Chung b·∫•t ƒë·ªça √°c ƒë·∫°o. | "These living beings will obtain great benefits in their birth and death and will ultimately not fall into the Evil Paths." | "Nh·ªØng ch√∫ng sanh ƒë√≥, l√∫c sanh l√∫c t·ª≠ t·ª± ƒë·∫∑ng l·ª£i √≠ch l·ªõn, tr·ªçn kh√¥ng b·ªã ƒë·ªça v√†o √°c ƒë·∫°o."
[00:04:34] Ëã•Êúâ‰∏¥ÂëΩÁªà‰∫∫„ÄÇÂÆ∂‰∏≠Áú∑Â±û„ÄÇ‰πÉËá≥‰∏Ä‰∫∫„ÄÇ‰∏∫ÊòØÁóÖ‰∫∫„ÄÇÈ´òÂ£∞Âøµ‰∏Ä‰ΩõÂêç„ÄÇ | ru√≤ y«íu l√≠n m√¨ng zh≈çng r√©n „ÄÇ jiƒÅ zh≈çng ju√†n sh«î „ÄÇ n«éi zh√¨ yƒ´ r√©n „ÄÇ w√®i sh√¨ b√¨ng r√©n „ÄÇ gƒÅo shƒìng ni√†n yƒ´ f√≥ m√≠ng „ÄÇ | Nh∆∞·ª£c h·ªØu l√¢m m·∫°ng chung nh√¢n. Gia trung quy·∫øn thu·ªôc. N√£i ch√≠ nh·∫•t nh√¢n. V·ªã th·ªã b·ªánh nh√¢n. Cao thanh ni·ªám nh·∫•t Ph·∫≠t danh. | "If a person is on the verge of death and his family members, even just one person, recite the name of one Buddha aloud for the sake of the sick person..." | "Nh∆∞ c√≥ ng∆∞·ªùi s·∫Øp m·∫°ng chung, h√†ng th√¢n quy·∫øn trong nh√†, cho ƒë·∫øn m·ªôt ng∆∞·ªùi, v√¨ ng∆∞·ªùi b·ªãnh s·∫Øp ch·∫øt ƒë√≥ m√† ni·ªám l·ªõn ti·∫øng danh hi·ªáu c·ªßa m·ªôt ƒë·ª©c Ph·∫≠t..."
[00:04:43] ÊòØÂëΩÁªà‰∫∫„ÄÇÈô§‰∫îÊó†Èó¥ÁΩ™„ÄÇ‰Ωô‰∏öÊä•Á≠â„ÄÇÊÇâÂæóÊ∂àÁÅ≠„ÄÇ | sh√¨ m√¨ng zh≈çng r√©n „ÄÇ ch√∫ w«î w√∫ ji√†n zu√¨ „ÄÇ y√∫ y√® b√†o dƒõng „ÄÇ xƒ´ d√© xiƒÅo mi√® „ÄÇ | Th·ªã m·∫°ng chung nh√¢n. Tr·ª´ ng≈© V√¥ Gi√°n t·ªôi. D∆∞ nghi·ªáp b√°o ƒë·∫≥ng. T·∫•t ƒë·∫Øc ti√™u di·ªát. | "...that dying person, except for the Five Uninterrupted Offenses, will have all other karmic retributions dissolved." | "...th·ªùi ng∆∞·ªùi ch·∫øt ƒë√≥, tr·ª´ nƒÉm t·ªôi l·ªõn V√¥ Gi√°n, c√°c nghi·ªáp b√°o kh√°c ƒë·ªÅu ti√™u s·∫°ch c·∫£."
[00:04:50] ÊòØ‰∫îÊó†Èó¥ÁΩ™„ÄÇËôΩËá≥ÊûÅÈáç„ÄÇÂä®Áªè‰∫øÂä´„ÄÇ‰∫Ü‰∏çÂæóÂá∫„ÄÇ | sh√¨ w«î w√∫ ji√†n zu√¨ „ÄÇ suƒ´ zh√¨ j√≠ zh√≤ng „ÄÇ d√≤ng jƒ´ng y√¨ ji√© „ÄÇ li«éo b√π d√© ch≈´ „ÄÇ | Th·ªã ng≈© V√¥ Gi√°n t·ªôi. Tuy ch√≠ c·ª±c tr·ªçng. ƒê·ªông kinh ·ª©c ki·∫øp. Li·ªÖu b·∫•t ƒë·∫Øc xu·∫•t. | "The Five Uninterrupted Offenses are extremely heavy, and one who commits them passes through millions of aeons without being able to leave." | "NƒÉm t·ªôi l·ªõn V√¥ Gi√°n kia, d·∫ßu r·∫•t n·∫∑ng n·ªÅ, tr·∫£i qua ·ª©c ki·∫øp h·∫≥n kh√¥ng ra kh·ªèi ƒë∆∞·ª£c..."
[00:04:57] ÊâøÊñØ‰∏¥ÂëΩÁªàÊó∂„ÄÇ‰ªñ‰∫∫‰∏∫ÂÖ∂Áß∞Âøµ‰ΩõÂêç„ÄÇ‰∫éÊòØÁΩ™‰∏≠„ÄÇ‰∫¶Ê∏êÊ∂àÁÅ≠„ÄÇ | ch√©ng sƒ´ l√≠n m√¨ng zh≈çng sh√≠ „ÄÇ tƒÅ r√©n w√®i q√≠ chƒìng ni√†n f√≥ m√≠ng „ÄÇ y√∫ sh√¨ zu√¨ zh≈çng „ÄÇ y√¨ ji√†n xiƒÅo mi√® „ÄÇ | Th·ª´a t∆∞ l√¢m m·∫°ng chung th·ªùi. Tha nh√¢n v·ªã k·ª≥ x∆∞ng ni·ªám Ph·∫≠t danh. ∆Ø th·ªã t·ªôi trung. Di·ªác ti·ªám ti√™u di·ªát. | "However, because others recite the Buddhas' names for him at the time of death, even these offenses can gradually be dissolved." | "...nh∆∞ng nh·ªù l√∫c l√¢m chung, ng∆∞·ªùi kh√°c v√¨ ƒë√≥ m√† x∆∞ng ni·ªám danh hi·ªáu c·ªßa Ph·∫≠t, th√¨ nh·ªØng t·ªôi n·∫∑ng ƒë√≥ c≈©ng l·∫ßn l·∫ßn ti√™u di·ªát."
[00:05:07] ‰ΩïÂÜµ‰ºóÁîüËá™Áß∞Ëá™Âøµ„ÄÇËé∑Á¶èÊó†Èáè„ÄÇÁÅ≠Êó†ÈáèÁΩ™„ÄÇ | h√© ku√†ng zh√≤ng shƒìng z√¨ chƒìng z√¨ ni√†n „ÄÇ hu√≤ f√∫ w√∫ li√†ng „ÄÇ mi√® w√∫ li√†ng zu√¨ „ÄÇ | H√† hu·ªëng ch√∫ng sanh t·ª± x∆∞ng t·ª± ni·ªám. Ho·∫°ch ph∆∞·ªõc v√¥ l∆∞·ª£ng. Di·ªát v√¥ l∆∞·ª£ng t·ªôi. | "How much more so if living beings recite the names themselves! They will obtain measureless blessings and dissolve measureless offenses." | "Hu·ªëng chi l√† ch√∫ng sanh t·ª± m√¨nh x∆∞ng danh hi·ªáu c·ªßa ch∆∞ Ph·∫≠t, ng∆∞·ªùi ƒë√≥ ƒë·∫∑ng ph∆∞·ªõc v√¥ l∆∞·ª£ng, ti√™u di·ªát v√¥ l∆∞·ª£ng t·ªôi."
`;

        // --- TAM THIEN TU DATA (Sample ~3000 Common Characters) ---
        const tamThienTuStr = "Â§©Âú∞‰∏æÂ≠òÂ≠êÂ≠ôÂÖ≠‰∏âÂÆ∂ÂõΩÂâçÂêéÁâõÈ©¨Ë∑ùÁâôÊó†ÊúâÁä¨ÁæäÂΩíËµ∞ÊãúË∑™ÂéªÊù•Â•≥Áî∑Â∏¶ÂÜ†Ë∂≥Â§öÁà±ÊÜéËØÜÁü•Êú®Ê†πÊòìÈöæÊó®ÁîòÊü±Ê¢ÅÂ∫äÂ∏≠Ê¨†‰ΩôÈîÑÈû†ÁÉõÁÅØÂçáÈôçÁî∞ÂÆÖËÄÅÁ´•ÈõÄÈ∏°Êàë‰ªñ‰ºØÂß®ÈìÖÈî°ÂΩπÂäüÁø∞ÁøºÂú£Ë¥§‰ªô‰ΩõÊΩ¶ÊΩÆÈ∏¢Âá§‰∏àÂØªÁõòÁõèËåß‰∏ùÊ¢ÖÊùéÊªìÊ∏ÖËÉ∏ËáÜÂ¢®Êú±Â®áÁÜüÊÖéÂªâÁßÅÊÖïËá≥Âõû‰π°Â∏ÇÂ¶áÂ§´ÂÜÖ‰∏≠Èó®Â±ãËã±ËíÇËè≤Ëë±ËãçÁôΩËã¶ÈÖ∏È©∫È©æÁü≥ÈáëÈü≥‰ø°Âê¨ÈóªÈ∏üÂÖΩÁæΩÊØõÁöÆËßíÁî≤È≥ûË°åÈ£ûÊΩúÊ≥≥ÈæôËôéÈæüÈ∫üÂçµËÉéÂåñÊπøÂΩ¢‰ΩìÈù¢Á•ûÈ¢êÁõÆÂè£ÂîáËàåÈΩøËÄ≥ÈºªÂñâÈ¢úÈ¨ìÁúâÂèëÂ§¥È¶ñËÑëÈ¢ùÈ°∂È¢êÈ¢îÈ°πÈ¢àËÇ©ËÉåËÜÇËÉÅËÖãËÖïËÇ±ËáÇÊâãÊéåÊåáÁî≤ËÑöËÖøËÜùËÉ´Ë∏ùË∏µË∂æË∫´Ë∫ØÈ™®ËÇâÈ´ìËÑëË°ÄËÑâÁ≠ãÁöÆËÇ†ËÉÉÂøÉËÇùËÑæËÇ∫ËÇæËÉÜËÉûËÉéÁ≤æÊ∞îÁ•ûÈ≠ÇÈ≠ÑÂøóÊÑèÂøµÊÉ≥ÊÄùËôëÂøßÊÑÅÂñúÊÄíÂìÄ‰πêÊÅêÊÉäÊÇ≤Ê¨¢ËÅ™ÊòéÊô∫ÊÖßÊÑöÁó¥ÊöóÈíùÊâçËâ∫ÊäÄËÉΩÂ∑•Â∑ßÁôæÂ∑•Â£´ÂÜúÂ∑•ÂïÜÂêõËá£Áà∂Â≠êÂ§´Â¶áÂÖÑÂºüÊúãÂèãÂÆæ‰∏ªÂ∏àÁîü‰∏ª‰ªÜÂ•¥Â©¢ÂÆòÂêèÂÖµÂçíÂ∞ÜÂ∏ÖÂÜõÊóÖÁî≤ËÉÑÂºìÁü¢ÂàÄÂâëÁüõÁõæÊóåÊóóÈºìÈí≤ËΩ¶ËàπËàüÊ•´Â∏ÜÊ®ØÊ©πÊ£πÊ°•Ê¢ÅÈÅìË∑ØË°óÂ∑∑ÂüéÈÉ≠ÂÆ´ÂÆ§ÊÆøÂ†Ç‰∫≠Âè∞Ê•ºÈòÅÂõ≠ÊûóÊ±†Ê≤ºÈôÇÂ°ò‰∫ïÁÅ∂ÈáúÁîëÁ¢óÁ¢üÊùØÁõòÂåôÁÆ∏Â£∂ËßûÂ∞äÁàµÂá†Ê°àÁÆ±ÁÆßÂõäÊ©êË°£Ë£≥ÂÜ†ÂÜïÈûãË¢úÁ∞™Áè•Áí∞ÈíèÈî¶Áª£ÁΩóÁªÆÂ∏ÉÂ∏õ‰∏ùÈ∫ªÊ£âÁµÆË£ÅÁºùÁ∫∫ÁªáËÄïÁ®ºÁßçÊ§çÊî∂Ëé∑‰ªìÂª™Â∫úÂ∫ìÈí±Ë¥¢Ë¥ßË¥øË¥∏Êòì‰π∞ÂçñÁß§Â∞∫ÊñóÊñõÊñ§‰∏§Èí±ÂàÜÈì¢ÂØ∏‰∏àÂØªÂ∏∏ÊØ´ÂéòÂú≠ÊíÆÊï∞ÁÆóÂä†Âáè‰πòÈô§Âπ¥ÊúàÊó•Êó∂Êò•Â§èÁßãÂÜ¨ÂØíÊöëÂÜ∑ÁÉ≠È£é‰∫ëÈõ®Èõ™Èõ∑ÁîµÈúúÈú≤ÈúûÈõæËôπÈúìÊòüËæ∞Êó•ÊúàÈò¥Èò≥‰πæÂù§ÂÆáÂÆô‰∏ñÁïåÂ±±Â∑ùÊ±üÊ≤≥ÊπñÊµ∑ÈôµÈôÜÈ´òÂéüÂπ≥ÂéüËçâÊú®Ëä±ÊûúÁ´πËãáÊùæÊüèÊ°ëÈ∫ªÁ®ªÁ≤±È∫¶Ë±ÜÈªçÁ®∑Á¶ΩÂÖΩËô´È±ºÈ£ûËµ∞ÊΩú‰ºèÂä®Ê§çÁüøÁâ©ÈáëÈì∂ÈìúÈìÅÈìÖÈî°Áè†ÁéâÂÆùÁü≥ÁêâÁíÉÁèäÁëöÁéõÁëôÁê•ÁèÄÁèçÁè†Ë±°ÁâôÁäÄËßíÈ∫ùÈ¶ôÁâõÈªÑËôéÈ™®ÈπøËå∏ÁÜäËÉÜÈæüÊùøÈ≥ñÁî≤ËùâËúïËõáÁöÆËúÇÊàøËöïÁ†ÇÁ∫¢ÈªÑËìùÁôΩÈªëÁ¥´ÁªøÈùíËµ§Ê©ôÁÅ∞Ë§êÊñπÂúÜÈïøÁü≠È´ò‰ΩéÂ§ßÂ∞èÂéöËñÑÂπøÁã≠Ê∑±ÊµÖËøúËøëËΩªÈáçÊÄ•ÁºìÂø´ÊÖ¢Â•ΩÂùèÂñÑÊÅ∂Áæé‰∏ëÊòØÈùûÁúüÂÅáËôöÂÆûÊúâÊó†ÂæóÂ§±ÊàêË¥•ÂÖ¥‰∫°ÁõõË°∞Ê≤ª‰π±ÂÆâÂç±ÂêâÂá∂Á•∏Á¶èÂØøÂ§≠Ë¥´ÂØåË¥µË¥±Â∞äÂçë‰∏ä‰∏ãÂ∑¶Âè≥ÂÜÖÂ§ñ‰∏≠Èó¥‰∏úË•øÂçóÂåóÂõõÊñπÂÖ´Èù¢Âè§‰ªäÂæÄÊù•ÂÆáÂÆôÊ¥™ËçíÁéÑÈªÑÊó•ÊúàÁõàÊòÉËæ∞ÂÆøÂàóÂº†ÂØíÊù•ÊöëÂæÄÁßãÊî∂ÂÜ¨ËóèÈó∞‰ΩôÊàêÂ≤ÅÂæãÂêïË∞ÉÈò≥‰∫ëËÖæËá¥Èõ®Èú≤Áªì‰∏∫ÈúúÈáëÁîü‰∏ΩÊ∞¥ÁéâÂá∫ÊòÜÂÜàÂâëÂè∑Â∑®ÈòôÁè†Áß∞Â§úÂÖâÊûúÁèçÊùéÊü∞ËèúÈáçËä•ÂßúÊµ∑Âí∏Ê≤≥Ê∑°È≥ûÊΩúÁæΩÁøîÈæôÂ∏àÁÅ´Â∏ùÈ∏üÂÆò‰∫∫ÁöáÂßãÂà∂ÊñáÂ≠ó‰πÉÊúçË°£Ë£≥Êé®‰ΩçËÆ©ÂõΩÊúâËôûÈô∂ÂîêÂêäÊ∞ë‰ºêÁΩ™Âë®ÂèëÊÆ∑Ê±§ÂùêÊúùÈóÆÈÅìÂûÇÊã±Âπ≥Á´†Áà±ËÇ≤ÈªéÈ¶ñËá£‰ºèÊàéÁæåÈÅêËø©‰∏Ä‰ΩìÁéáÂÆæÂΩíÁéãÈ∏£Âá§Âú®Á´πÁôΩÈ©πÈ£üÂú∫ÂåñË¢´ËçâÊú®ËµñÂèä‰∏áÊñπÁõñÊ≠§Ë∫´ÂèëÂõõÂ§ß‰∫îÂ∏∏ÊÅ≠ÊÉüÈû†ÂÖªÂ≤ÇÊï¢ÊØÅ‰º§Â•≥ÊÖïË¥ûÊ¥ÅÁî∑ÊïàÊâçËâØÁü•ËøáÂøÖÊîπÂæóËÉΩËé´ÂøòÁΩîË∞àÂΩºÁü≠Èù°ÊÅÉÂ∑±Èïø‰ø°‰ΩøÂèØË¶ÜÂô®Ê¨≤ÈöæÈáèÂ¢®ÊÇ≤‰∏ùÊüìËØóËµûÁæîÁæäÊôØË°åÁª¥Ë¥§ÂÖãÂøµ‰ΩúÂú£Âæ∑Âª∫ÂêçÁ´ãÂΩ¢Á´ØË°®Ê≠£Á©∫Ë∞∑‰º†Â£∞ËôöÂ†Ç‰π†Âê¨Á•∏Âõ†ÊÅ∂ÁßØÁ¶èÁºòÂñÑÂ∫ÜÂ∞∫ÁíßÈùûÂÆùÂØ∏Èò¥ÊòØÁ´ûËµÑÁà∂‰∫ãÂêõÊõ∞‰∏•‰∏éÊï¨Â≠ùÂΩìÁ´≠ÂäõÂø†ÂàôÂ∞ΩÂëΩ‰∏¥Ê∑±Â±•ËñÑÂ§ôÂÖ¥Ê∏©Ê∏Ö‰ººÂÖ∞ÊñØÈ¶®Â¶ÇÊùæ‰πãÁõõÂ∑ùÊµÅ‰∏çÊÅØÊ∏äÊæÑÂèñÊò†ÂÆπÊ≠¢Ëã•ÊÄùË®ÄËæûÂÆâÂÆöÁ¨ÉÂàùËØöÁæéÊÖéÁªàÂÆú‰ª§Ëç£‰∏öÊâÄÂü∫Á±çÁîöÊó†Á´üÂ≠¶‰ºòÁôª‰ªïÊëÑËÅå‰ªéÊîøÂ≠ò‰ª•ÁîòÊ£†ÂéªËÄåÁõäÂíè‰πêÊÆäË¥µË¥±Á§ºÂà´Â∞äÂçë‰∏äÂíå‰∏ãÁù¶Â§´Âî±Â¶áÈöèÂ§ñÂèóÂÇÖËÆ≠ÂÖ•Â•âÊØç‰ª™ËØ∏Âßë‰ºØÂèîÁäπÂ≠êÊØîÂÑøÂ≠îÊÄÄÂÖÑÂºüÂêåÊ∞îËøûÊûù‰∫§ÂèãÊäïÂàÜÂàáÁ£®ÁÆ¥ËßÑ‰ªÅÊÖàÈöêÊÅªÈÄ†Ê¨°ÂºóÁ¶ªËäÇ‰πâÂªâÈÄÄÈ¢†Ê≤õÂå™‰∫èÊÄßÈùôÊÉÖÈÄ∏ÂøÉÂä®Á•ûÁñ≤ÂÆàÁúüÂøóÊª°ÈÄêÁâ©ÊÑèÁßªÂùöÊåÅÈõÖÊìçÂ•ΩÁàµËá™Á∏ªÈÉΩÈÇëÂçéÂ§è‰∏úË•ø‰∫å‰∫¨ËÉåÈÇôÈù¢Ê¥õÊµÆÊ∏≠ÊçÆÊ≥æÂÆ´ÊÆøÁõòÈÉÅÊ•ºËßÇÈ£ûÊÉäÂõæÂÜôÁ¶ΩÂÖΩÁîªÂΩ©‰ªôÁÅµ‰∏ôËàçÂÇçÂêØÁî≤Â∏êÂØπÊ•πËÇÜÁ≠µËÆæÂ∏≠ÈºìÁëüÂêπÁ¨ôÂçáÈò∂Á∫≥ÈôõÂºÅËΩ¨ÁñëÊòüÂè≥ÈÄöÂπøÂÜÖÂ∑¶ËææÊâøÊòéÊó¢ÈõÜÂùüÂÖ∏‰∫¶ËÅöÁæ§Ëã±ÊùúÁ®øÈíüÈö∂ÊºÜ‰π¶Â£ÅÁªèÂ∫úÁΩóÂ∞ÜÁõ∏Ë∑Ø‰æ†ÊßêÂçøÊà∑Â∞ÅÂÖ´ÂéøÂÆ∂ÁªôÂçÉÂÖµÈ´òÂÜ†Èô™ËæáÈ©±ÊØÇÊåØÁº®‰∏ñÁ¶Ñ‰æàÂØåËΩ¶È©æËÇ•ËΩªÁ≠ñÂäüËåÇÂÆûÂãíÁ¢ëÂàªÈì≠Á£ªÊ∫™‰ºäÂ∞π‰ΩêÊó∂ÈòøË°°Â•ÑÂÆÖÊõ≤ÈòúÂæÆÊó¶Â≠∞Ëê•Ê°ìÂÖ¨Âå°ÂêàÊµéÂº±Êâ∂ÂÄæÁªÆÂõûÊ±âÊÉ†ËØ¥ÊÑüÊ≠¶‰∏Å‰øä‰πÇÂØÜÂãøÂ§öÂ£´ÂØîÂÆÅÊôãÊ•öÊõ¥Èú∏ËµµÈ≠èÂõ∞Ê®™ÂÅáÈÄîÁÅ≠ÂüüË∑µÂúü‰ºöÁõü‰ΩïÈÅµÁ∫¶Ê≥ïÈü©ÂºäÁÉ¶ÂàëËµ∑Áø¶È¢áÁâßÁî®ÂÜõÊúÄÁ≤æÂÆ£Â®ÅÊ≤ôÊº†È©∞Ë™â‰∏πÈùí‰πùÂ∑ûÁ¶πËøπÁôæÈÉ°Áß¶Âπ∂Â≤≥ÂÆóÊ≥∞Â≤±Á¶Ö‰∏ª‰∫ë‰∫≠ÈõÅÈó®Á¥´Â°ûÈ∏°Áî∞Ëµ§ÂüéÊòÜÊ±†Á¢£Áü≥Â∑®ÈáéÊ¥ûÂ∫≠Êó∑ËøúÁªµÈÇàÂ≤©Â≤´Êù≥ÂÜ•Ê≤ªÊú¨‰∫éÂÜúÂä°ÂÖπÁ®ºÁ©ë‰ø∂ËΩΩÂçó‰∫©ÊàëËâ∫ÈªçÁ®∑Á®éÁÜüË¥°Êñ∞ÂäùËµèÈªúÈôüÂ≠üËΩ≤Êï¶Á¥†Âè≤È±ºÁßâÁõ¥Â∫∂Âá†‰∏≠Â∫∏Âä≥Ë∞¶Ë∞®ÊïïËÅÜÈü≥ÂØüÁêÜÈâ¥Ë≤åËæ®Ëâ≤Ë¥ªÂé•ÂòâÁå∑ÂãâÂÖ∂Á•óÊ§çÁúÅË∫¨ËÆ•ËØ´ÂÆ†Â¢ûÊäóÊûÅÊÆÜËæ±ËøëËÄªÊûóÁöãÂπ∏Âç≥‰∏§ÁñèËßÅÊú∫Ëß£ÁªÑË∞ÅÈÄºÁ¥¢Â±ÖÈó≤Â§ÑÊ≤âÈªòÂØÇÂØ•Ê±ÇÂè§ÂØªËÆ∫Êï£ËôëÈÄçÈÅ•Ê¨£Â•èÁ¥ØÈÅ£ÊàöË∞¢Ê¨¢ÊãõÊ∏†Ëç∑ÁöÑÂéÜÂõ≠ËéΩÊäΩÊù°ÊûáÊù∑ÊôöÁø†Ê¢ßÊ°êÊó©ÂáãÈôàÊ†πÂßîÁø≥ËêΩÂè∂È£òÊëáÊ∏∏ÈπçÁã¨ËøêÂáåÊë©ÁªõÈúÑ";
        
        const tamThienTuSet = new Set(tamThienTuStr);

        // --- APP STATE ---
        let transcripts = [];
        let simulationInterval = null;
        let isPlaying = false;
        let currentSimulationTime = 0; 
        const simulationSpeed = 1; 
        let analysisMode = false;
        let vocabChartInstance = null;

        // --- CORE FUNCTIONS ---

        // 1. Text-to-Speech Functionality (iOS Optimized & Retry Logic)
        
        // GLOBAL VARIABLE to prevent iOS Safari Garbage Collection (Critical Fix)
        window.currentUtterance = null; 
        let availableVoices = [];

        function loadVoices() {
            if ('speechSynthesis' in window) {
                availableVoices = window.speechSynthesis.getVoices();
            }
        }
        
        // Initialize voices (Chrome loads immediately, iOS waits for event)
        if ('speechSynthesis' in window) {
            loadVoices();
            window.speechSynthesis.onvoiceschanged = loadVoices;
        }

        function speakText(text, btnId, retry = true) {
            if (!text) return; // Prevent empty text errors

            if ('speechSynthesis' in window) {
                // Cancel current speech if any to avoid queue backup
                window.speechSynthesis.cancel();
                
                // Visual feedback
                if(btnId) {
                    document.querySelectorAll('.speaking-active').forEach(el => el.classList.remove('speaking-active'));
                    const btn = document.getElementById(btnId);
                    if(btn) btn.classList.add('speaking-active');
                }

                // Create Utterance
                const utterance = new SpeechSynthesisUtterance(text);
                
                // --- iOS FIX: EXPLICITLY FIND CHINESE VOICE ---
                // iOS sometimes ignores 'lang' property if voice is not set explicitly
                if (retry) {
                    if (availableVoices.length === 0) {
                        availableVoices = window.speechSynthesis.getVoices();
                    }
                    
                    const zhVoice = availableVoices.find(v => v.lang === 'zh-CN') || 
                                    availableVoices.find(v => v.lang.startsWith('zh'));
                    
                    if (zhVoice) {
                        utterance.voice = zhVoice;
                        utterance.lang = zhVoice.lang;
                    } else {
                        utterance.lang = 'zh-CN'; // Fallback
                    }
                } else {
                    // Retry with minimal configuration to avoid "isTrusted" errors
                    utterance.lang = 'zh-CN'; 
                    // Do not set specific voice object on retry
                }
                
                utterance.rate = 0.8; // Slower rate for learning
                
                // --- iOS FIX: PREVENT GARBAGE COLLECTION ---
                // Assign to global variable so Safari doesn't kill it mid-speech
                window.currentUtterance = utterance;

                utterance.onend = function() {
                    if(btnId) {
                        const btn = document.getElementById(btnId);
                        if(btn) btn.classList.remove('speaking-active');
                    }
                    window.currentUtterance = null; // Clean up
                };

                utterance.onerror = function(e) {
                    console.error("Speech Error:", e);
                    
                    // Smart Retry Logic for "isTrusted" errors
                    if (retry) {
                        console.log("Retrying speech with simple configuration...");
                        // Clear active state momentarily
                        if(btnId) {
                            const btn = document.getElementById(btnId);
                            if(btn) btn.classList.remove('speaking-active');
                        }
                        
                        setTimeout(() => {
                            speakText(text, btnId, false); // Retry with retry=false
                        }, 100);
                        return;
                    }

                    if(btnId) {
                        const btn = document.getElementById(btnId);
                        if(btn) btn.classList.remove('speaking-active');
                    }
                };

                window.speechSynthesis.speak(utterance);
            } else {
                console.warn("Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ Text-to-Speech");
            }
        }

        // 2. Parse Data
        function parseSubtitles(raw) {
            const lines = raw.trim().split('\n');
            const parsed = [];
            // Regex captures: 1=HH, 2=MM, 3=SS, 4=Chinese, 5=Pinyin, 6=Viet (Han), 7=English, 8=Viet (Trans)
            const regex = /\[(\d{2}):(\d{2}):(\d{2})\]\s*(.*?)\s*\|\s*(.*?)\s*\|\s*(.*?)\s*\|\s*(.*?)\s*\|\s*(.*)/;

            lines.forEach((line, index) => {
                const match = line.match(regex);
                if (match) {
                    const hours = parseInt(match[1]);
                    const minutes = parseInt(match[2]);
                    const seconds = parseInt(match[3]);
                    const cnText = match[4].trim();
                    const pinyinText = match[5].trim();
                    const vietHanText = match[6].trim();
                    const enText = match[7].trim();
                    const vietTransText = match[8].trim();
                    const totalSeconds = hours * 3600 + minutes * 60 + seconds;
                    
                    parsed.push({
                        id: index,
                        timeFormatted: `${hours > 0 ? match[1] + ':' : ''}${match[2]}:${match[3]}`,
                        seconds: totalSeconds,
                        cn: cnText,
                        pinyin: pinyinText,
                        vietHan: vietHanText,
                        en: enText,
                        vietTrans: vietTransText,
                        // Search text combined
                        searchText: (cnText + ' ' + pinyinText + ' ' + vietHanText + ' ' + enText + ' ' + vietTransText).toLowerCase()
                    });
                }
            });
            return parsed;
        }

        // 3. Analyze Vocabulary (unchanged logic)
        function analyzeVocabulary(items) {
            const allChars = new Set();
            items.forEach(item => {
                const chars = item.cn.match(/[\u4e00-\u9fa5]/g);
                if (chars) chars.forEach(c => allChars.add(c));
            });

            let inCount = 0;
            let outCount = 0;
            const total = allChars.size;

            allChars.forEach(char => {
                if (tamThienTuSet.has(char)) inCount++;
                else outCount++;
            });

            const inPerc = total > 0 ? Math.round((inCount / total) * 100) : 0;
            const outPerc = total > 0 ? 100 - inPerc : 0;

            document.getElementById('uniqueCharCount').textContent = total;
            document.getElementById('inTTTCount').textContent = inCount;
            document.getElementById('inTTTPerc').textContent = `${inPerc}%`;
            document.getElementById('outTTTCount').textContent = outCount;
            document.getElementById('outTTTPerc').textContent = `${outPerc}%`;

            const commentEl = document.getElementById('analysisComment');
            if (inPerc > 80) commentEl.textContent = `VƒÉn b·∫£n s·ª≠ d·ª•ng ph·∫ßn l·ªõn l√† c√°c ch·ªØ cƒÉn b·∫£n (${inPerc}%), cho th·∫•y ng√¥n ng·ªØ kinh ƒëi·ªÉn kh√° g·∫ßn g≈©i v√† d·ªÖ ti·∫øp c·∫≠n v·ªõi ng∆∞·ªùi c√≥ v·ªën H√°n ng·ªØ c∆° s·ªü.`;
            else if (inPerc > 50) commentEl.textContent = `VƒÉn b·∫£n c√≥ s·ª± k·∫øt h·ª£p c√¢n b·∫±ng gi·ªØa t·ª´ v·ª±ng cƒÉn b·∫£n v√† thu·∫≠t ng·ªØ chuy√™n s√¢u.`;
            else commentEl.textContent = `VƒÉn b·∫£n ch·ª©a nhi·ªÅu thu·∫≠t ng·ªØ chuy√™n m√¥n ho·∫∑c ch·ªØ hi·∫øm g·∫∑p, c·∫ßn tra c·ª©u k·ªπ.`;

            renderVocabChart(inCount, outCount);
        }

        function renderVocabChart(inCount, outCount) {
            const ctx = document.getElementById('vocabChart').getContext('2d');
            if(vocabChartInstance) vocabChartInstance.destroy();
            
            // Determine if dark mode is active (by checking body bg color)
            const isDark = getComputedStyle(document.body).backgroundColor === 'rgb(28, 25, 23)'; // Stone 900
            const textColor = isDark ? '#e7e5e4' : '#44403c';

            vocabChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Trong Tam Thi√™n T·ª±', 'Ngo√†i danh s√°ch'],
                    datasets: [{
                        data: [inCount, outCount],
                        backgroundColor: ['#22c55e', '#f59e0b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom', 
                            labels: { 
                                usePointStyle: true, 
                                font: { family: "'Noto Sans', sans-serif" },
                                color: textColor
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const val = context.raw;
                                    const total = context.chart._metasets[context.datasetIndex].total;
                                    const perc = Math.round((val/total)*100) + '%';
                                    return ` ${context.label}: ${val} (${perc})`;
                                }
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }

        // 4. Render List (Updated with Audio Button)
        function renderList(items) {
            const container = document.getElementById('transcriptContainer');
            container.innerHTML = '';
            
            if (items.length === 0) {
                container.innerHTML = '<div class="p-8 text-center text-stone-500 flex flex-col items-center gap-2"><span class="text-2xl">üì≠</span><span>Kh√¥ng t√¨m th·∫•y n·ªôi dung ph√π h·ª£p.</span></div>';
                document.getElementById('visibleCount').textContent = '0 c√¢u';
                return;
            }

            items.forEach((item, index) => {
                const div = document.createElement('div');
                div.id = `line-${item.id}`;
                div.className = 'transcript-item p-4 rounded-lg cursor-pointer mb-2';
                div.onclick = () => jumpToTime(item.seconds);
                
                let processedCn = item.cn;
                if (analysisMode) {
                    processedCn = item.cn.split('').map(char => {
                        if (/[\u4e00-\u9fa5]/.test(char)) {
                            if (tamThienTuSet.has(char)) {
                                return `<span class="char-basic" title="C√≥ trong Tam Thi√™n T·ª±">${char}</span>`;
                            } else {
                                return `<span class="char-advanced" title="Kh√¥ng c√≥ trong danh s√°ch">${char}</span>`;
                            }
                        }
                        return char;
                    }).join('');
                }

                // Add Audio Button (Stop propagation to prevent jump when clicking audio)
                // Note: We send Chinese text (item.cn) to the TTS engine because engines pronounce Hanzi correctly as Pinyin.
                div.innerHTML = `
                    <div class="flex gap-4 items-start relative pr-8">
                        <span class="text-xs font-mono text-amber-500 bg-amber-900/30 px-2 py-1 rounded h-fit shrink-0 mt-2 border border-amber-800/50">${item.timeFormatted}</span>
                        <div class="flex-1 space-y-1">
                            <div class="cn-text text-xl">${processedCn}</div>
                            <div class="pinyin-text">${item.pinyin}</div>
                            <div class="viet-han-text">${item.vietHan}</div>
                            <div class="viet-trans-text">${item.vietTrans}</div>
                            <div class="en-text">${item.en}</div>
                        </div>
                        <button id="audio-btn-${item.id}" 
                                onclick="event.stopPropagation(); speakText('${item.cn.replace(/'/g, "\\'")}', 'audio-btn-${item.id}')" 
                                class="absolute right-0 top-2 text-stone-600 hover:text-amber-500 transition-all p-2 rounded-full hover:bg-stone-700/50 audio-btn" 
                                title="Nghe ƒë·ªçc Pinyin">
                            üîä
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
            
            document.getElementById('visibleCount').textContent = `${items.length} c√¢u`;
        }

        // 5. Initialize Stats & Jump
        function initJumpSelect(data) {
            const select = document.getElementById('jumpSelect');
            if(data.length === 0) return;
            const totalMinutes = Math.ceil(data[data.length - 1].seconds / 60);
            select.innerHTML = '<option value="0">00:00 - Kh·ªüi ƒë·∫ßu</option>';
            for(let i = 1; i <= totalMinutes; i++) {
                const option = document.createElement('option');
                option.value = i * 60;
                option.textContent = `${i < 10 ? '0'+i : i}:00`;
                select.appendChild(option);
            }
            select.addEventListener('change', (e) => jumpToTime(parseInt(e.target.value)));
        }

        // 6. Simulation Logic
        function jumpToTime(seconds) {
            currentSimulationTime = seconds;
            updateTimeDisplay(currentSimulationTime);
            highlightCurrentLine();
            scrollToActive();
        }
        function updateTimeDisplay(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            const formatted = `${h > 0 ? h + ':' : ''}${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
            document.getElementById('currentTimeDisplay').textContent = formatted;
        }
        function highlightCurrentLine() {
            let activeItem = null;
            for (let i = transcripts.length - 1; i >= 0; i--) {
                if (transcripts[i].seconds <= currentSimulationTime) {
                    activeItem = transcripts[i];
                    break;
                }
            }
            
            // Check if active item changed
            const currentActive = document.querySelector('.active-line');
            const newActiveId = activeItem ? `line-${activeItem.id}` : null;
            
            if (currentActive && currentActive.id !== newActiveId) {
                currentActive.classList.remove('active-line');
            }

            if (activeItem && (!currentActive || currentActive.id !== newActiveId)) {
                const el = document.getElementById(newActiveId);
                if (el) {
                    el.classList.add('active-line');
                    // Auto Read Logic
                    if(isPlaying && document.getElementById('autoRead').checked) {
                        speakText(activeItem.cn, `audio-btn-${activeItem.id}`);
                    }
                }
            }
        }
        function scrollToActive() {
            const active = document.querySelector('.active-line');
            if (active) active.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        function togglePlay() {
            const btnPlay = document.getElementById('btnPlay');
            const btnPause = document.getElementById('btnPause');
            if (isPlaying) {
                clearInterval(simulationInterval);
                window.speechSynthesis.cancel(); // Stop audio on pause
                isPlaying = false;
                btnPlay.classList.remove('hidden'); btnPlay.classList.add('flex');
                btnPause.classList.add('hidden');
            } else {
                isPlaying = true;
                btnPlay.classList.add('hidden');
                btnPause.classList.remove('hidden'); btnPause.classList.add('flex');
                
                // Trigger immediate highlight check for audio start
                highlightCurrentLine();

                simulationInterval = setInterval(() => {
                    currentSimulationTime++;
                    updateTimeDisplay(currentSimulationTime);
                    highlightCurrentLine(); // This triggers audio if needed
                    if(currentSimulationTime % 2 === 0) scrollToActive();
                    if (transcripts.length > 0 && currentSimulationTime > transcripts[transcripts.length-1].seconds + 20) togglePlay();
                }, 1000 / simulationSpeed);
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            transcripts = parseSubtitles(rawSubtitleData);
            analyzeVocabulary(transcripts);
            renderList(transcripts);
            initJumpSelect(transcripts);
            
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = transcripts.filter(t => 
                    t.searchText.includes(term) || t.timeFormatted.includes(term)
                );
                renderList(filtered);
            });

            document.getElementById('btnPlay').addEventListener('click', togglePlay);
            document.getElementById('btnPause').addEventListener('click', togglePlay);
            document.getElementById('btnReset').addEventListener('click', () => {
                if(isPlaying) togglePlay();
                jumpToTime(0);
            });

            const tttBtn = document.getElementById('tttToggle');
            tttBtn.addEventListener('click', () => {
                analysisMode = !analysisMode;
                if (analysisMode) {
                    tttBtn.classList.add('bg-green-900', 'border-green-700', 'ring-2', 'ring-green-500', 'ring-offset-1', 'ring-offset-stone-900');
                    tttBtn.classList.remove('bg-stone-800');
                    document.getElementById('transcriptContainer').classList.add('analysis-mode-active');
                    document.getElementById('analysisLegend').classList.remove('hidden');
                    
                    const term = document.getElementById('searchInput').value.toLowerCase();
                    const currentItems = transcripts.filter(t => t.searchText.includes(term));
                    renderList(currentItems);
                    highlightCurrentLine();
                    scrollToActive();
                    document.getElementById('analysisLegend').scrollIntoView({behavior: 'smooth', block: 'center'});
                } else {
                    tttBtn.classList.remove('bg-green-900', 'border-green-700', 'ring-2', 'ring-green-500', 'ring-offset-1', 'ring-offset-stone-900');
                    tttBtn.classList.add('bg-stone-800');
                    document.getElementById('transcriptContainer').classList.remove('analysis-mode-active');
                    document.getElementById('analysisLegend').classList.add('hidden');
                    
                    const term = document.getElementById('searchInput').value.toLowerCase();
                    renderList(transcripts.filter(t => t.searchText.includes(term)));
                    highlightCurrentLine();
                }
            });

            const modeBtn = document.getElementById('modeToggle');
            let isLightMode = false; // Default is Dark now
            modeBtn.addEventListener('click', () => {
                isLightMode = !isLightMode;
                const body = document.body;
                
                // Toggle Logic
                if(isLightMode) {
                    // Switch to LIGHT
                    body.style.backgroundColor = '#fdfbf7'; 
                    body.style.color = '#44403c';
                    modeBtn.textContent = "üåô Ch·∫ø ƒë·ªô T·ªëi";
                    modeBtn.classList.remove('text-stone-300');
                    modeBtn.classList.add('text-stone-700', 'bg-stone-100');

                    // Global elements styles for Light
                    document.querySelectorAll('.bg-stone-900').forEach(el => el.classList.replace('bg-stone-900', 'bg-white'));
                    document.querySelectorAll('.bg-stone-800').forEach(el => el.classList.replace('bg-stone-800', 'bg-white'));
                    document.querySelectorAll('.text-stone-200').forEach(el => el.classList.replace('text-stone-200', 'text-stone-800'));
                    document.querySelectorAll('.text-stone-400').forEach(el => el.classList.replace('text-stone-400', 'text-stone-500'));
                    
                    // Specific Text Colors
                    const cnEls = document.querySelectorAll('.cn-text');
                    cnEls.forEach(el => el.style.color = '#292524');
                    const vietHanEls = document.querySelectorAll('.viet-han-text');
                    vietHanEls.forEach(el => el.style.color = '#b45309');
                    const vietTransEls = document.querySelectorAll('.viet-trans-text');
                    vietTransEls.forEach(el => el.style.color = '#15803d');
                    const enEls = document.querySelectorAll('.en-text');
                    enEls.forEach(el => el.style.color = '#57534e');
                    
                } else {
                    // Switch to DARK (Default)
                    body.style.backgroundColor = '#1c1917'; 
                    body.style.color = '#e7e5e4';
                    modeBtn.textContent = "‚òÄÔ∏è Ch·∫ø ƒë·ªô S√°ng";
                    modeBtn.classList.add('text-stone-300');
                    modeBtn.classList.remove('text-stone-700', 'bg-stone-100');
                    
                    location.reload(); 
                }
            });
        });
    </script>
</body>
</html>
