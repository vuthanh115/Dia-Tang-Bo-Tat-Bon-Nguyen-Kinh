<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kinh ƒê·ªãa T·∫°ng - Ph·∫©m 2 (Audio Pinyin)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#1c1917',      /* Stone 900 */
                            card: '#292524',    /* Stone 800 */
                            border: '#44403c',  /* Stone 700 */
                            text: '#e7e5e4',    /* Stone 200 */
                            muted: '#a8a29e'    /* Stone 400 */
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif:wght@400;700&family=Noto+Sans:wght@300;400;500;600&family=Be+Vietnam+Pro:wght@400;500;600&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500;700&display=swap'); /* Font for Chinese */
        
        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #1c1917; /* Stone 900 - Dark Mode Default */
            color: #e7e5e4; /* Stone 200 */
        }
        
        h1, h2, h3, .serif {
            font-family: 'Noto Serif', serif;
        }

        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 300px; 
            max-height: 400px; 
        }

        /* Custom scrollbar - Dark version */
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background: #292524;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background-color: #57534e;
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover {
            background-color: #78716c;
        }

        /* Active line - Dark version */
        .active-line {
            background-color: #451a03; /* Amber 950/Darker */
            border-left: 4px solid #f59e0b; /* Amber 500 */
            padding-left: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .transcript-item {
            transition: all 0.2s ease;
            border-left: 4px solid transparent;
            border-bottom: 1px solid #44403c; /* Stone 700 */
            position: relative; /* For absolute positioning of audio button */
        }
        .transcript-item:hover {
            background-color: #292524; /* Stone 800 */
            border-left-color: #57534e;
        }

        /* Typography for multi-lingual display - DARK MODE COLORS */
        .cn-text {
            font-family: "Noto Serif SC", "SimSun", serif;
            font-size: 1.6em;
            color: #e7e5e4; /* Stone 200 - White-ish */
            margin-bottom: 0.2rem;
            line-height: 1.4;
            font-weight: 500;
        }
        .pinyin-text {
            color: #a8a29e; /* Stone 400 - Light Gray */
            font-size: 0.85em;
            margin-bottom: 0.35rem;
            font-family: 'Noto Sans', sans-serif;
            font-style: italic;
        }
        .viet-han-text {
            color: #fbbf24; /* Amber 400 - Bright Amber */
            font-size: 1.05em;
            font-weight: 700;
            line-height: 1.5;
            font-family: 'Noto Serif', serif;
            margin-bottom: 0.2rem;
        }
        .viet-trans-text {
            color: #86efac; /* Green 300 - Light Green */
            font-size: 1.05em;
            font-family: 'Be Vietnam Pro', sans-serif;
            line-height: 1.6;
            margin-bottom: 0.2rem;
            font-weight: 500;
        }
        .en-text {
            color: #78716c; /* Stone 500 - Dim Gray */
            font-size: 0.9em;
            font-style: italic;
            font-family: 'Noto Serif', serif;
            line-height: 1.4;
            opacity: 0.8;
        }

        /* Highlight classes for Tam Thien Tu analysis - Dark Mode Adapted */
        .char-basic {
            color: #14532d; /* Green 900 */
            background-color: #86efac; /* Green 300 */
            border-radius: 2px;
            padding: 0 2px;
            font-weight: bold;
        }
        .char-advanced {
            color: #f59e0b; /* Amber 500 */
            border-bottom: 1px dotted #f59e0b;
        }
        
        .analysis-mode-active .cn-text {
            line-height: 1.8;
        }
        
        /* Audio Button Pulse Animation */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 6px rgba(245, 158, 11, 0); }
            100% { transform: scale(0.8); box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); }
        }
        .speaking-active .audio-btn {
            color: #fbbf24;
            animation: pulse-ring 2s infinite;
        }

        /* Utility for input placeholder in dark mode */
        ::placeholder {
            color: #78716c;
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Navigation / Header -->
    <header class="bg-stone-900 shadow-md border-b border-stone-700 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-9 h-9 rounded-full bg-amber-700 flex items-center justify-center text-white font-bold serif shadow-sm shadow-amber-900">ƒê</div>
                <div>
                    <h1 class="text-lg md:text-xl font-bold text-stone-200 tracking-wide serif leading-tight">Kinh ƒê·ªãa T·∫°ng</h1>
                    <p class="text-xs text-stone-500 font-medium">Ph·∫©m 2: Ph√¢n Th√¢n T·∫≠p H·ªôi</p>
                </div>
            </div>
            <nav class="hidden md:flex gap-6 text-sm font-medium text-stone-400">
                <a href="#dashboard" class="hover:text-amber-500 transition-colors">T·ªïng Quan</a>
                <a href="#hanzi-analysis" class="hover:text-amber-500 transition-colors">Ph√¢n T√≠ch H√°n T·ª±</a>
                <a href="#transcript" class="hover:text-amber-500 transition-colors">N·ªôi Dung</a>
            </nav>
            <div class="flex gap-2">
                <button id="tttToggle" class="px-3 py-2 bg-stone-800 hover:bg-stone-700 text-green-400 rounded-md text-sm font-medium transition-colors border border-stone-700" title="T√¥ m√†u ch·ªØ c√≥ trong Tam Thi√™n T·ª±">
                    üåø Soi Tam Thi√™n T·ª±
                </button>
                <button id="modeToggle" class="px-3 py-2 bg-stone-800 hover:bg-stone-700 text-stone-300 rounded-md text-sm font-medium transition-colors border border-stone-700">
                    ‚òÄÔ∏è Ch·∫ø ƒë·ªô S√°ng
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 space-y-10 max-w-6xl">

        <!-- Hanzi Analysis Dashboard -->
        <section id="hanzi-analysis" class="bg-stone-800 p-6 md:p-8 rounded-2xl shadow-lg border border-stone-700">
            <div class="mb-6 pb-4 border-b border-stone-700 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <h3 class="text-xl font-bold text-stone-200 flex items-center gap-2 serif">
                        <span class="text-green-500">üìñ</span> Ph√¢n T√≠ch T·ª´ V·ª±ng (Tam Thi√™n T·ª±)
                    </h3>
                    <p class="text-sm text-stone-400 mt-1">
                        ƒê·ªëi chi·∫øu ch·ªØ H√°n trong Ph·∫©m 2 v·ªõi danh s√°ch 3.000 ch·ªØ cƒÉn b·∫£n.
                    </p>
                </div>
                <div class="text-right">
                    <div class="text-2xl font-bold text-stone-200" id="uniqueCharCount">0</div>
                    <div class="text-xs text-stone-500">T·ªïng ch·ªØ H√°n duy nh·∫•t (kh√¥ng l·∫∑p)</div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Chart -->
                <div class="col-span-1 h-64 chart-container flex items-center justify-center">
                    <canvas id="vocabChart"></canvas>
                </div>

                <!-- Details -->
                <div class="col-span-2 space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 bg-green-900/20 rounded-lg border border-green-800/50">
                            <div class="text-sm text-green-400 font-medium mb-1">Thu·ªôc Tam Thi√™n T·ª±</div>
                            <div class="text-3xl font-bold text-green-500" id="inTTTCount">0</div>
                            <div class="text-xs text-green-400/70 mt-1" id="inTTTPerc">0%</div>
                        </div>
                        <div class="p-4 bg-amber-900/20 rounded-lg border border-amber-800/50">
                            <div class="text-sm text-amber-400 font-medium mb-1">Ngo√†i Tam Thi√™n T·ª±</div>
                            <div class="text-3xl font-bold text-amber-500" id="outTTTCount">0</div>
                            <div class="text-xs text-amber-400/70 mt-1" id="outTTTPerc">0%</div>
                        </div>
                    </div>
                    
                    <div class="bg-stone-900/50 p-4 rounded-lg text-sm text-stone-400 border border-stone-700">
                        <p class="mb-2 font-semibold text-stone-300">Nh·∫≠n x√©t:</p>
                        <p id="analysisComment">ƒêang ph√¢n t√≠ch d·ªØ li·ªáu...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Transcript & Interactive Player -->
        <section id="transcript" class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            
            <!-- Controls Column (Left) -->
            <div class="lg:col-span-4 bg-stone-800 p-6 rounded-xl shadow-lg border border-stone-700 sticky top-24">
                <h3 class="text-lg font-bold text-stone-200 mb-4 serif border-b pb-2 border-stone-700">B·∫£ng ƒêi·ªÅu Khi·ªÉn</h3>
                
                <div class="space-y-6">
                    <!-- Simulation Controls -->
                    <div class="p-4 bg-amber-900/20 rounded-lg border border-amber-800/30">
                        <p class="text-sm text-amber-500 mb-3 font-semibold flex items-center gap-2">
                            üéß M√¥ ph·ªèng t·ª•ng
                        </p>
                        <div class="flex gap-2">
                            <button id="btnPlay" class="flex-1 bg-amber-700 hover:bg-amber-600 text-white py-2.5 px-4 rounded shadow-sm text-sm font-medium transition-colors flex justify-center items-center gap-2">
                                <span>‚ñ∂</span> B·∫Øt ƒë·∫ßu
                            </button>
                            <button id="btnPause" class="flex-1 bg-stone-700 border border-stone-600 hover:bg-stone-600 text-amber-400 py-2.5 px-4 rounded shadow-sm text-sm font-medium transition-colors hidden">
                                <span>‚è∏</span> T·∫°m d·ª´ng
                            </button>
                            <button id="btnReset" class="px-3 bg-stone-700 border border-stone-600 hover:bg-stone-600 text-stone-300 rounded shadow-sm transition-colors" title="Quay l·∫°i t·ª´ ƒë·∫ßu">
                                ‚Ü∫
                            </button>
                        </div>
                        <div class="flex justify-between items-center mt-3 px-1">
                            <span class="text-xs text-amber-500 font-mono" id="currentTimeDisplay">00:00</span>
                            <span class="text-xs text-amber-500/50">T·ª± ƒë·ªông cu·ªôn</span>
                        </div>
                        <div class="mt-3 flex items-center gap-2">
                            <input type="checkbox" id="autoRead" class="rounded border-stone-600 text-amber-600 focus:ring-amber-500 bg-stone-900">
                            <label for="autoRead" class="text-xs text-stone-400 cursor-pointer select-none">T·ª± ƒë·ªông ƒë·ªçc Pinyin khi ch·∫°y</label>
                        </div>
                    </div>

                    <!-- Search/Filter -->
                    <div>
                        <label class="block text-xs font-semibold uppercase text-stone-500 mb-1.5 tracking-wide">T√¨m ki·∫øm</label>
                        <div class="relative">
                            <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm (Vi·ªát, Anh, H√°n)..." 
                                   class="w-full pl-9 pr-3 py-2 bg-stone-900 border border-stone-700 text-stone-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 text-sm shadow-sm placeholder-stone-600">
                            <span class="absolute left-3 top-2.5 text-stone-500">üîç</span>
                        </div>
                    </div>

                    <!-- Jump To -->
                    <div>
                        <label class="block text-xs font-semibold uppercase text-stone-500 mb-1.5 tracking-wide">Chuy·ªÉn nhanh</label>
                        <select id="jumpSelect" class="w-full px-3 py-2 border border-stone-700 rounded-lg bg-stone-900 text-stone-300 text-sm focus:ring-amber-500 focus:border-amber-500 shadow-sm cursor-pointer hover:bg-stone-950">
                            <option value="0">00:00 - Kh·ªüi ƒë·∫ßu</option>
                            <!-- Options populated by JS -->
                        </select>
                    </div>

                    <!-- Legend for Analysis -->
                    <div id="analysisLegend" class="hidden p-4 bg-stone-900/50 rounded-lg border border-stone-700">
                        <p class="text-xs font-bold text-stone-500 uppercase mb-2">Ch√∫ gi·∫£i m√†u s·∫Øc</p>
                        <div class="flex flex-col gap-2 text-sm">
                            <div class="flex items-center gap-2">
                                <span class="px-1 bg-green-300 text-green-900 rounded font-bold font-serif">Â§©</span>
                                <span class="text-stone-400">C√≥ trong Tam Thi√™n T·ª±</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="px-1 text-amber-500 font-serif border-b border-dotted border-amber-500">Âøâ</span>
                                <span class="text-stone-400">Kh√¥ng c√≥ trong danh s√°ch</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- List Column (Right) -->
            <div class="lg:col-span-8">
                <div class="bg-stone-800 rounded-xl shadow-lg border border-stone-700 overflow-hidden flex flex-col h-[700px]">
                    <div class="p-4 border-b border-stone-700 bg-stone-800/80 flex flex-wrap gap-2 justify-between items-center backdrop-blur-sm sticky top-0 z-10">
                        <div class="flex items-center gap-2">
                            <span class="font-bold text-stone-300 serif">N·ªôi Dung Kinh VƒÉn</span>
                            <span class="px-2 py-0.5 text-xs bg-stone-700 text-stone-300 rounded border border-stone-600">H√°n</span>
                            <span class="px-2 py-0.5 text-xs bg-amber-900/40 text-amber-400 rounded border border-amber-800/50">√Çm</span>
                            <span class="px-2 py-0.5 text-xs bg-green-900/40 text-green-400 rounded border border-green-800/50">Nghƒ©a</span>
                            <span class="px-2 py-0.5 text-xs bg-stone-700/50 text-stone-500 rounded border border-stone-700">Anh</span>
                        </div>
                        <span class="text-xs text-stone-400 bg-stone-700 px-2.5 py-1 rounded-full font-medium" id="visibleCount">0 c√¢u</span>
                    </div>
                    
                    <div id="transcriptContainer" class="flex-1 overflow-y-auto custom-scroll p-2 space-y-1 relative scroll-smooth bg-stone-900">
                        <!-- Content populated by JS -->
                        <div class="flex flex-col items-center justify-center h-full text-stone-600 gap-2">
                            <svg class="animate-spin h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span>ƒêang t·∫£i d·ªØ li·ªáu...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-stone-950 text-stone-500 py-10 mt-12 border-t border-stone-800">
        <div class="container mx-auto px-4 text-center">
            <div class="serif text-xl text-stone-400 mb-3">Nam M√¥ ƒê·∫°i Nguy·ªán ƒê·ªãa T·∫°ng V∆∞∆°ng B·ªì T√°t</div>
            <p class="text-sm opacity-60">D·ªØ li·ªáu ƒë∆∞·ª£c tr√≠ch xu·∫•t t·ª´ ngu·ªìn: A Di ƒê√† Ph·∫≠t TV (YouTube)</p>
            <p class="text-xs opacity-40 mt-2">Ph√¢n t√≠ch d·ª±a tr√™n danh s√°ch Tam Thi√™n T·ª± (~3000 ch·ªØ cƒÉn b·∫£n)</p>
        </div>
    </footer>

    <!-- RAW DATA STORAGE -->
    <script>
        // Updated Data for Chapter 2
        const rawSubtitleData = `
[00:00:00] Âú∞ËóèËè©Ëê®Êú¨ÊÑøÁªè ÂàÜË∫´ÈõÜ‰ºöÂìÅÁ¨¨‰∫å | d√¨ z√†ng p√∫ s√† bƒõn yu√†n jƒ´ng fƒìn shƒìn j√≠ hu√¨ p«ên d√¨ √®r | ƒê·ªãa T·∫°ng B·ªì T√°t B·ªïn Nguy·ªán Kinh - Ph√¢n Th√¢n T·∫≠p H·ªôi ph·∫©m ƒë·ªá nh·ªã | Sutra of the Past Vows of Earth Store Bodhisattva - Chapter 2: The Assembly of Divided Bodies | Kinh ƒê·ªãa T·∫°ng B·ªì T√°t B·ªïn Nguy·ªán - Ph·∫©m th·ª© hai: Ph√¢n th√¢n t·∫≠p h·ªôi.
[00:00:10] Â∞îÊó∂ÁôæÂçÉ‰∏á‰∫ø‰∏çÂèØÊÄù„ÄÇ‰∏çÂèØËÆÆ„ÄÇ‰∏çÂèØÈáè„ÄÇ‰∏çÂèØËØ¥„ÄÇÊó†ÈáèÈòøÂÉßÁ•á‰∏ñÁïå„ÄÇ | ƒõr sh√≠ b«éi qiƒÅn w√†n y√¨ b√π kƒõ sƒ´ „ÄÇ b√π kƒõ y√¨ „ÄÇ b√π kƒõ li√†ng „ÄÇ b√π kƒõ shu≈ç „ÄÇ w√∫ li√†ng ƒÅ sƒìng q√≠ sh√¨ ji√® „ÄÇ | Nhƒ© th·ªùi b√°ch thi√™n v·∫°n ·ª©c b·∫•t kh·∫£ t∆∞. B·∫•t kh·∫£ ngh·ªã. B·∫•t kh·∫£ l∆∞·ª£ng. B·∫•t kh·∫£ thuy·∫øt. V√¥ l∆∞·ª£ng a tƒÉng k·ª≥ th·∫ø gi·ªõi. | At that time, from hundreds of thousands of millions of inconceivable, inexpressible, immeasurable, ineffable, limitless Asankhyeyas of worlds. | L√∫c ƒë√≥, ph√¢n th√¢n ƒê·ªãa T·∫°ng B·ªì T√°t ·ªü c√°c n∆°i c√≥ ƒë·ªãa ng·ª•c trong trƒÉm ngh√¨n mu√¥n ·ª©c b·∫•t kh·∫£ t∆∞, b·∫•t kh·∫£ ngh·ªã, b·∫•t kh·∫£ l∆∞·ª£ng, b·∫•t kh·∫£ thuy·∫øt, v√¥ l∆∞·ª£ng a tƒÉng k·ª≥ th·∫ø gi·ªõi.
[00:00:22] ÊâÄÊúâÂú∞Áã±Â§Ñ„ÄÇÂàÜË∫´Âú∞ËóèËè©Ëê®„ÄÇ‰ø±Êù•ÈõÜÂú®ÂøâÂà©Â§©ÂÆ´„ÄÇ | su«í y«íu d√¨ y√π ch√π „ÄÇ fƒìn shƒìn d√¨ z√†ng p√∫ s√† „ÄÇ j√π l√°i j√≠ z√†i dƒÅo l√¨ tiƒÅn g≈çng „ÄÇ | S·ªü h·ªØu ƒë·ªãa ng·ª•c x·ª©. Ph√¢n th√¢n ƒê·ªãa T·∫°ng B·ªì T√°t. C·ª• lai t·∫≠p t·∫°i ƒêao L·ª£i thi√™n cung. | All the division bodies of Earth Store Bodhisattva from all the hells gathered in the Palace of the Trayastrimsa Heaven. | ƒê·ªÅu ƒë·∫øn h·ªôi h·ªçp t·∫°i cung tr·ªùi ƒêao L·ª£i.
[00:00:29] ‰ª•Â¶ÇÊù•Á•ûÂäõÊïÖ„ÄÇÂêÑ‰ª•ÊñπÈù¢„ÄÇ‰∏éËØ∏ÂæóËß£ËÑ±„ÄÇ‰ªé‰∏öÈÅìÂá∫ËÄÖ„ÄÇ‰∫¶ÂêÑÊúâÂçÉ‰∏á‰∫øÈÇ£Áî±‰ªñÊï∞„ÄÇ | y«ê r√∫ l√°i sh√©n l√¨ g√π „ÄÇ g√® y«ê fƒÅng mi√†n „ÄÇ y«î zh≈´ d√© jiƒõ tu≈ç „ÄÇ c√≥ng y√® d√†o ch≈´ zhƒõ „ÄÇ y√¨ g√® y«íu qiƒÅn w√†n y√¨ n√† y√≥u tƒÅ sh√π „ÄÇ | Dƒ© Nh∆∞ Lai th·∫ßn l·ª±c c·ªë. C√°c dƒ© ph∆∞∆°ng di·ªán. D·ªØ ch∆∞ ƒë·∫Øc gi·∫£i tho√°t. T√πng nghi·ªáp ƒë·∫°o xu·∫•t gi·∫£. Di·ªác c√°c h·ªØu thi√™n v·∫°n ·ª©c na do tha s·ªë. | By means of the Tathagata's spiritual power, each came from his own direction together with thousands of millions of nayutas of beings who had obtained liberation from the paths of karma. | Do nh·ªù th·∫ßn l·ª±c c·ªßa ƒë·ª©c Nh∆∞ Lai, n√™n ph√¢n th√¢n ƒê·ªãa T·∫°ng ·ªü c√°c ph∆∞∆°ng ƒë·ªÅu c√πng v·ªõi nh·ªØng ch√∫ng ƒë√£ ƒë∆∞·ª£c gi·∫£i tho√°t ·ªü ch·ªën nghi·ªáp ƒë·∫°o, s·ªë ƒë·∫øn ngh√¨n mu√¥n ·ª©c na do tha.
[00:00:41] ÂÖ±ÊåÅÈ¶ôÂçé„ÄÇÊù•‰æõÂÖª‰Ωõ„ÄÇÂΩºËØ∏ÂêåÊù•Á≠âËæà„ÄÇÁöÜÂõ†Âú∞ËóèËè©Ëê®ÊïôÂåñ„ÄÇÊ∞∏‰∏çÈÄÄËΩ¨‰∫éÈòøËÄ®Â§öÁΩó‰∏âËóê‰∏âËè©Êèê„ÄÇ | g√≤ng ch√≠ xiƒÅng huƒÅ „ÄÇ l√°i g√≤ng y√†ng f√≥ „ÄÇ b«ê zh≈´ t√≥ng l√°i dƒõng b√®i „ÄÇ jiƒì yƒ´n d√¨ z√†ng p√∫ s√† ji√†o hu√† „ÄÇ y«íng b√π tu√¨ zhu«én y√∫ ƒÅ n√≤u du≈ç lu√≥ sƒÅn mi«éo sƒÅn p√∫ t√≠ „ÄÇ | C·ªông tr√¨ h∆∞∆°ng hoa. Lai c√∫ng d∆∞·ªùng Ph·∫≠t. B·ªâ ch∆∞ ƒë·ªìng lai ƒë·∫≥ng b·ªëi. Giai nh√¢n ƒê·ªãa T·∫°ng B·ªì T√°t gi√°o h√≥a. Vƒ©nh b·∫•t th·ªëi chuy·ªÉn ∆∞ A N·∫≠u ƒêa La Tam Mi·ªáu Tam B·ªì ƒê·ªÅ. | They all held incense and flowers as offerings to the Buddha. All those who came were transformed by Earth Store Bodhisattva's teaching and would never retreat from Anuttarasamyaksambodhi. | ƒê·ªìng c·∫ßm h∆∞∆°ng hoa ƒë·∫øn c√∫ng d∆∞·ªùng Ph·∫≠t. Nh·ªØng ch√∫ng c√πng ƒë·∫øn ·∫•y, th·∫£y ƒë·ªÅu nh·ªù ƒê·ªãa T·∫°ng B·ªì T√°t gi√°o h√≥a l√†m cho vƒ©nh vi·ªÖn kh√¥ng c√≤n th·ªëi chuy·ªÉn n∆°i ƒë·∫°o V√¥ Th∆∞·ª£ng Ch√°nh ƒê·∫≥ng Ch√°nh Gi√°c.
[00:00:54] ÊòØËØ∏‰ºóÁ≠â„ÄÇ‰πÖËøúÂä´Êù•„ÄÇÊµÅÊµ™ÁîüÊ≠ª„ÄÇÂÖ≠ÈÅìÂèóËã¶„ÄÇÊöÇÊó†‰ºëÊÅØ„ÄÇ | sh√¨ zh≈´ zh√≤ng dƒõng „ÄÇ ji«î yu«én ji√© l√°i „ÄÇ li√∫ l√†ng shƒìng s«ê „ÄÇ li√π d√†o sh√≤u k«î „ÄÇ z√†n w√∫ xi≈´ xƒ´ „ÄÇ | Th·ªã ch∆∞ ch√∫ng ƒë·∫≥ng. C·ª≠u vi·ªÖn ki·∫øp lai. L∆∞u l√£ng sanh t·ª≠. L·ª•c ƒë·∫°o th·ªç kh·ªï. T·∫°m v√¥ h∆∞u t·ª©c. | For long aeons, these beings had flowed and wandered in birth and death, undergoing suffering in the Six Paths without temporary rest. | Nh·ªØng ch√∫ng sinh ƒë√≥ t·ª´ ki·∫øp l√¢u xa ƒë·∫øn nay tr√¥i lƒÉn trong v√≤ng sanh t·ª≠, ch·ªãu kh·ªï trong s√°u ƒë∆∞·ªùng, kh√¥ng l√∫c n√†o t·∫°m ng·ª´ng d·ª©t.
[00:01:03] ‰ª•Âú∞ËóèËè©Ëê®ÂπøÂäøÊÇ≤ÊÑø„ÄÇÂêÑËé∑ÊûúËØÅ„ÄÇ | y«ê d√¨ z√†ng p√∫ s√† gu«éng sh√¨ bƒìi yu√†n „ÄÇ g√® hu√≤ gu«í zh√®ng „ÄÇ | Dƒ© ƒê·ªãa T·∫°ng B·ªì T√°t qu·∫£ng th·∫ø bi nguy·ªán. C√°c ho·∫°ch qu·∫£ ch·ª©ng. | Because of Earth Store Bodhisattva's vast compassion and vows, they had each realized the fruition. | Nh·ªù l√≤ng t·ª´ bi r·ªông l·ªõn v√† th·ªá nguy·ªán s√¢u d√†y c·ªßa ƒê·ªãa T·∫°ng B·ªì T√°t, n√™n t·∫•t c·∫£ ƒë·ªÅu ch·ª©ng ƒë∆∞·ª£c ƒë·∫°o qu·∫£.
[00:01:09] Êó¢Ëá≥ÂøâÂà©„ÄÇÂøÉÊÄÄË∏äË∑É„ÄÇÁûª‰ª∞Â¶ÇÊù•„ÄÇÁõÆ‰∏çÊöÇËàç„ÄÇ | j√¨ zh√¨ dƒÅo l√¨ „ÄÇ xƒ´n hu√°i y«íng yu√® „ÄÇ zhƒÅn y«éng r√∫ l√°i „ÄÇ m√π b√π z√†n shƒõ „ÄÇ | K√Ω ch√≠ ƒêao L·ª£i. T√¢m ho√†i d≈©ng d∆∞·ª£c. Chi√™m ng∆∞·ª°ng Nh∆∞ Lai. M·ª•c b·∫•t t·∫°m x·∫£. | Having arrived at the Trayastrimsa Heaven, their hearts were filled with joy. They gazed at the Tathagata, their eyes not leaving him for a moment. | Khi ƒë√£ ƒë·∫øn cung tr·ªùi ƒêao L·ª£i, l√≤ng h·ªç vui m·ª´ng h·ªõn h·ªü, chi√™m ng∆∞·ª°ng ƒë·ª©c Nh∆∞ Lai m·∫Øt nh√¨n m√£i kh√¥ng r·ªùi.
[00:01:17] Â∞îÊó∂‰∏ñÂ∞äËàíÈáëËâ≤ËáÇ„ÄÇÊë©ÁôæÂçÉ‰∏á‰∫ø‰∏çÂèØÊÄù„ÄÇ‰∏çÂèØËÆÆ„ÄÇ‰∏çÂèØÈáè„ÄÇ‰∏çÂèØËØ¥„ÄÇÊó†ÈáèÈòøÂÉßÁ•á‰∏ñÁïå„ÄÇ | ƒõr sh√≠ sh√¨ z≈´n sh≈´ jƒ´n s√® b√¨ „ÄÇ m√≥ b«éi qiƒÅn w√†n y√¨ b√π kƒõ sƒ´ „ÄÇ b√π kƒõ y√¨ „ÄÇ b√π kƒõ li√†ng „ÄÇ b√π kƒõ shu≈ç „ÄÇ w√∫ li√†ng ƒÅ sƒìng q√≠ sh√¨ ji√® „ÄÇ | Nhƒ© th·ªùi Th·∫ø T√¥n th∆∞ kim s·∫Øc t√Ω. Ma b√°ch thi√™n v·∫°n ·ª©c b·∫•t kh·∫£ t∆∞. B·∫•t kh·∫£ ngh·ªã. B·∫•t kh·∫£ l∆∞·ª£ng. B·∫•t kh·∫£ thuy·∫øt. V√¥ l∆∞·ª£ng a tƒÉng k·ª≥ th·∫ø gi·ªõi. | At that time, the World Honored One extended his golden arm and rubbed the crowns of all the division bodies of Earth Store Bodhisattva... | B·∫•y gi·ªù, ƒë·ª©c Th·∫ø T√¥n gi∆° c√°nh tay s·∫Øc v√†ng xoa ƒë·∫£nh c·ªßa ph√¢n th√¢n ƒê·ªãa T·∫°ng B·ªì T√°t ·ªü trong trƒÉm ngh√¨n mu√¥n ·ª©c b·∫•t kh·∫£ t∆∞, b·∫•t kh·∫£ ngh·ªã, b·∫•t kh·∫£ l∆∞·ª£ng, b·∫•t kh·∫£ thuy·∫øt v√¥ l∆∞·ª£ng a tƒÉng k·ª≥ th·∫ø gi·ªõi...
[00:01:30] ËØ∏ÂàÜË∫´Âú∞ËóèËè©Ëê®Êë©ËØÉËê®È°∂„ÄÇËÄå‰ΩúÊòØË®Ä„ÄÇ | zh≈´ fƒìn shƒìn d√¨ z√†ng p√∫ s√† m√≥ hƒì s√† d«êng „ÄÇ √©r zu√≤ sh√¨ y√°n „ÄÇ | Ch∆∞ ph√¢n th√¢n ƒê·ªãa T·∫°ng B·ªì T√°t Ma Ha T√°t ƒë·∫£nh. Nhi t√°c th·ªã ng√¥n. | ...from hundreds of thousands of millions of inconceivable... worlds, and said: | ...m√† b·∫£o r·∫±ng:
[00:01:36] Âêæ‰∫é‰∫îÊµäÊÅ∂‰∏ñ„ÄÇÊïôÂåñÂ¶ÇÊòØÂàöÂº∫‰ºóÁîü„ÄÇ‰ª§ÂøÉË∞É‰ºè„ÄÇËàçÈÇ™ÂΩíÊ≠£„ÄÇÂçÅÊúâ‰∏Ä‰∫å„ÄÇÂ∞öÊÅ∂‰π†Âú®„ÄÇ | w√∫ y√∫ w«î zhu√≥ √® sh√¨ „ÄÇ ji√†o hu√† r√∫ sh√¨ gƒÅng qi√°ng zh√≤ng shƒìng „ÄÇ l√¨ng xƒ´n ti√°o f√∫ „ÄÇ shƒõ xi√© guƒ´ zh√®ng „ÄÇ sh√≠ y«íu yƒ´ √®r „ÄÇ sh√†ng √® x√≠ z√†i „ÄÇ | Ng√¥ ∆∞ ng≈© tr∆∞·ª£c √°c th·∫ø. Gi√°o h√≥a nh∆∞ th·ªã cang c∆∞·ªùng ch√∫ng sanh. Linh t√¢m ƒëi·ªÅu ph·ª•c. X·∫£ t√† quy ch√°nh. Th·∫≠p h·ªØu nh·∫•t nh·ªã. Th∆∞·ª£ng √°c t·∫≠p t·∫°i. | "I teach and transform such stubborn living beings in the evil world of the Five Turbidities, causing their minds to be tamed, to renounce the deviant, and to return to the proper. However, one or two out of ten still hold onto their bad habits." | "Ta ·ªü trong ƒë·ªùi √°c ng≈© tr∆∞·ª£c gi√°o h√≥a nh·ªØng ch√∫ng sanh cang c∆∞·ªùng nh∆∞ th·∫ø, l√†m cho l√≤ng ch√∫ng n√≥ ƒëi·ªÅu ph·ª•c b·ªè t√† v·ªÅ ch√°nh; nh∆∞ng trong m∆∞·ªùi ph·∫ßn, v·∫´n c√≤n m·ªôt hai ph·∫ßn sanh t√°nh quen theo th√≥i √°c."
[00:01:50] Âêæ‰∫¶ÂàÜË∫´ÂçÉÁôæ‰∫ø„ÄÇÂπøËÆæÊñπ‰æø„ÄÇÊàñÊúâÂà©Ê†π„ÄÇÈóªÂç≥‰ø°Âèó„ÄÇ | w√∫ y√¨ fƒìn shƒìn qiƒÅn b«éi y√¨ „ÄÇ gu«éng sh√® fƒÅng bi√†n „ÄÇ hu√≤ y«íu l√¨ gƒìn „ÄÇ w√©n j√≠ x√¨n sh√≤u „ÄÇ | Ng√¥ di·ªác ph√¢n th√¢n thi√™n b√°ch ·ª©c. Qu·∫£ng thi·∫øt ph∆∞∆°ng ti·ªán. Ho·∫∑c h·ªØu l·ª£i cƒÉn. VƒÉn t·ª©c t√≠n th·ªç. | "I also divide into hundreds of thousands of millions of bodies to establish vast expedient devices. Some have keen roots and believe and accept immediately upon hearing." | "Mu·ªën ƒë·ªô ch√∫ng ƒë√≥, Ta c≈©ng ph√¢n ngh√¨n trƒÉm ·ª©c th√¢n l·∫≠p ra nhi·ªÅu ph∆∞∆°ng ch∆∞·ªõc. Ho·∫∑c l√† ng∆∞·ªùi c√≥ l·ª£i cƒÉn, nghe t·ª©c th√¨ tin nh·∫≠n."
[00:01:58] ÊàñÊúâÂñÑÊûú„ÄÇÂã§ÂäùÊàêÂ∞±„ÄÇÊàñÊúâÊöóÈíù„ÄÇ‰πÖÂåñÊñπÂΩí„ÄÇÊàñÊúâ‰∏öÈáç„ÄÇ‰∏çÁîüÊï¨‰ª∞„ÄÇ | hu√≤ y«íu sh√†n gu«í „ÄÇ q√≠n qu√†n ch√©ng ji√π „ÄÇ hu√≤ y«íu √†n d√πn „ÄÇ ji«î hu√† fƒÅng guƒ´ „ÄÇ hu√≤ y«íu y√® zh√≤ng „ÄÇ b√π shƒìng j√¨ng y«éng „ÄÇ | Ho·∫∑c h·ªØu thi·ªán qu·∫£. C·∫ßn khuy·∫øn th√†nh t·ª±u. Ho·∫∑c h·ªØu √°m ƒë·ªôn. C·ª≠u h√≥a ph∆∞∆°ng quy. Ho·∫∑c h·ªØu nghi·ªáp tr·ªçng. B·∫•t sanh k√≠nh ng∆∞·ª°ng. | "Some have good fruition and are accomplished through diligent exhortation. Some have dark and dull roots and only return after long transformation. Some have heavy karma and do not give rise to respect." | "Ho·∫∑c l√† ng∆∞·ªùi c√≥ thi·ªán qu·∫£, ph·∫£i √¢n c·∫ßn khuy√™n b·∫£o m·ªõi ƒë∆∞·ª£c th√†nh t·ª±u. Ho·∫∑c l√† k·∫ª √°m ƒë·ªôn, ph·∫£i gi√°o h√≥a l√¢u m·ªõi quay v·ªÅ. Ho·∫∑c l√† k·∫ª nghi·ªáp n·∫∑ng, ch·∫≥ng sanh l√≤ng k√≠nh ng∆∞·ª°ng."
[00:02:10] Â¶ÇÊòØÁ≠âËæà‰ºóÁîü„ÄÇÂêÑÂêÑÂ∑ÆÂà´„ÄÇÂàÜË∫´Â∫¶ËÑ±„ÄÇ | r√∫ sh√¨ dƒõng b√®i zh√≤ng shƒìng „ÄÇ g√® g√® chƒÅ bi√© „ÄÇ fƒìn shƒìn d√π tu≈ç „ÄÇ | Nh∆∞ th·ªã ƒë·∫≥ng b·ªëi ch√∫ng sanh. C√°c c√°c sai bi·ªát. Ph√¢n th√¢n ƒë·ªô tho√°t. | "For such beings, each different from the other, I divide my body to cross them over." | "Ch√∫ng sanh cƒÉn t√°nh m·ªói ng∆∞·ªùi m·ªói kh√°c nh∆∞ th·∫ø, n√™n Ta ph·∫£i ph√¢n th√¢n ra ƒë·ªÉ ƒë·ªô tho√°t."
[00:02:16] ÊàñÁé∞Áî∑Â≠êË∫´„ÄÇÊàñÁé∞Â•≥‰∫∫Ë∫´„ÄÇÊàñÁé∞Â§©ÈæôË∫´„ÄÇÊàñÁé∞Á•ûÈ¨ºË∫´„ÄÇ | hu√≤ xi√†n n√°n z«ê shƒìn „ÄÇ hu√≤ xi√†n n«ö r√©n shƒìn „ÄÇ hu√≤ xi√†n tiƒÅn l√≥ng shƒìn „ÄÇ hu√≤ xi√†n sh√©n gu«ê shƒìn „ÄÇ | Ho·∫∑c hi·ªán nam t·ª≠ th√¢n. Ho·∫∑c hi·ªán n·ªØ nh√¢n th√¢n. Ho·∫∑c hi·ªán thi√™n long th√¢n. Ho·∫∑c hi·ªán th·∫ßn qu·ª∑ th√¢n. | "I may appear in a man's body, a woman's body, a heavenly dragon's body, a ghost or spirit's body..." | "Ho·∫∑c hi·ªán ra th√¢n nam t·ª≠, ho·∫∑c hi·ªán ra th√¢n n·ªØ nh√¢n, ho·∫∑c hi·ªán ra th√¢n Tr·ªùi, R·ªìng, ho·∫∑c hi·ªán ra th√¢n Qu·ª∑, Th·∫ßn..."
[00:02:22] ÊàñÁé∞Â±±ÊûóÂ∑ùÂéü„ÄÇÊ≤≥Ê±†Ê≥â‰∫ï„ÄÇÂà©Âèä‰∫é‰∫∫„ÄÇÊÇâÁöÜÂ∫¶ËÑ±„ÄÇ | hu√≤ xi√†n shƒÅn l√≠n chuƒÅn yu√°n „ÄÇ h√© ch√≠ qu√°n j«êng „ÄÇ l√¨ j√≠ y√∫ r√©n „ÄÇ xƒ´ jiƒì d√π tu≈ç „ÄÇ | Ho·∫∑c hi·ªán s∆°n l√¢m xuy√™n nguy√™n. H√† tr√¨ tuy·ªÅn t·ªânh. L·ª£i c·∫≠p ∆∞ nh√¢n. T·∫•t giai ƒë·ªô tho√°t. | "...or appear as a mountain, forest, stream, spring, or well to benefit people, so that they are all liberated." | "...ho·∫∑c hi·ªán ra n√∫i, r·ª´ng, ngu·ªìn, ng√≤i, s√¥ng, ao, su·ªëi, gi·∫øng... l√†m l·ª£i √≠ch cho ng∆∞·ªùi, ƒë·ªÉ r·ªìi ƒë·ªô h·ªç ƒë∆∞·ª£c gi·∫£i tho√°t."
[00:02:29] ÊàñÁé∞Â§©Â∏ùË∫´„ÄÇÊàñÁé∞Ê¢µÁéãË∫´„ÄÇÊàñÁé∞ËΩ¨ËΩÆÁéãË∫´„ÄÇÊàñÁé∞Â±ÖÂ£´Ë∫´„ÄÇ | hu√≤ xi√†n tiƒÅn d√¨ shƒìn „ÄÇ hu√≤ xi√†n f√†n w√°ng shƒìn „ÄÇ hu√≤ xi√†n zhu«én l√∫n w√°ng shƒìn „ÄÇ hu√≤ xi√†n j≈´ sh√¨ shƒìn „ÄÇ | Ho·∫∑c hi·ªán Thi√™n ƒê·∫ø th√¢n. Ho·∫∑c hi·ªán Ph·∫°m V∆∞∆°ng th√¢n. Ho·∫∑c hi·ªán Chuy·ªÉn Lu√¢n V∆∞∆°ng th√¢n. Ho·∫∑c hi·ªán C∆∞ Sƒ© th√¢n. | "I may appear as the body of an Emperor of Heavens, a Brahma King, a Wheel-Turning King, a Layman..." | "Ho·∫∑c hi·ªán ra th√¢n Thi√™n ƒê·∫ø, ho·∫∑c hi·ªán ra th√¢n Ph·∫°m V∆∞∆°ng, ho·∫∑c hi·ªán ra th√¢n Chuy·ªÉn Lu√¢n V∆∞∆°ng, ho·∫∑c hi·ªán ra th√¢n C∆∞ Sƒ©..."
[00:02:37] ÊàñÁé∞ÂõΩÁéãË∫´„ÄÇÊàñÁé∞ÂÆ∞ËæÖË∫´„ÄÇÊàñÁé∞ÂÆòÂ±ûË∫´„ÄÇÊàñÁé∞ÊØî‰∏òÊØî‰∏òÂ∞º„ÄÇ‰ºòÂ©ÜÂ°û‰ºòÂ©ÜÂ§∑Ë∫´„ÄÇ | hu√≤ xi√†n gu√≥ w√°ng shƒìn „ÄÇ hu√≤ xi√†n z«éi f«î shƒìn „ÄÇ hu√≤ xi√†n guƒÅn sh«î shƒìn „ÄÇ hu√≤ xi√†n b«ê qi≈´ b«ê qi≈´ n√≠ „ÄÇ y≈çu p√≥ sƒÅi y≈çu p√≥ y√≠ shƒìn „ÄÇ | Ho·∫∑c hi·ªán Qu·ªëc V∆∞∆°ng th√¢n. Ho·∫∑c hi·ªán T·ªÉ Ph·ª• th√¢n. Ho·∫∑c hi·ªán Quan Thu·ªôc th√¢n. Ho·∫∑c hi·ªán T·ª≥ Kheo T·ª≥ Kheo Ni. ∆Øu B√† T·∫Øc ∆Øu B√† Di th√¢n. | "...a King of a country, a minister, an official, a Bhikshu, a Bhikshuni, an Upasaka, an Upasika..." | "Ho·∫∑c hi·ªán ra th√¢n Qu·ªëc V∆∞∆°ng, ho·∫∑c hi·ªán ra th√¢n T·ªÉ Ph·ª•, ho·∫∑c hi·ªán ra th√¢n Quan Thu·ªôc, ho·∫∑c hi·ªán ra th√¢n T·ª≥ kheo, T·ª≥ kheo ni, ∆Øu b√† t·∫Øc, ∆Øu b√† di..."
[00:02:46] ‰πÉËá≥Â£∞ÈóªÁΩóÊ±â„ÄÇËæüÊîØ‰Ωõ„ÄÇËè©Ëê®Á≠âË∫´„ÄÇËÄå‰ª•ÂåñÂ∫¶„ÄÇÈùû‰ΩÜ‰ΩõË∫´Áã¨Áé∞ÂÖ∂Ââç„ÄÇ | n«éi zh√¨ shƒìng w√©n lu√≥ h√†n „ÄÇ p√¨ zhƒ´ f√≥ „ÄÇ p√∫ s√† dƒõng shƒìn „ÄÇ √©r y«ê hu√† d√π „ÄÇ fƒìi d√†n f√≥ shƒìn d√∫ xi√†n q√≠ qi√°n „ÄÇ | N√£i ch√≠ Thanh VƒÉn La H√°n. B√≠ch Chi Ph·∫≠t. B·ªì T√°t ƒë·∫≥ng th√¢n. Nhi dƒ© h√≥a ƒë·ªô. Phi ƒë·∫£n Ph·∫≠t th√¢n ƒë·ªôc hi·ªán k·ª≥ ti·ªÅn. | "...and even the bodies of Sound Hearers, Arhats, Pratyekabuddhas, and Bodhisattvas, in order to teach and rescue them. It is not only the body of a Buddha that appears before them." | "...cho ƒë·∫øn hi·ªán ra nh·ªØng th√¢n Thanh VƒÉn, La H√°n, B√≠ch Chi Ph·∫≠t v√† B·ªì T√°t ƒë·ªÉ h√≥a ƒë·ªô ch√∫ng sanh, ch·ªõ ch·∫≥ng ph·∫£i ch·ªâ c√≥ th√¢n Ph·∫≠t hi·ªán ra tr∆∞·ªõc ch√∫ng th√¥i ƒë√¢u."
[00:02:56] Ê±ùËßÇÂêæÁ¥ØÂä´Âã§Ëã¶„ÄÇÂ∫¶ËÑ±Â¶ÇÊòØÁ≠âÈöæÂåñÂàöÂº∫ÁΩ™Ëã¶‰ºóÁîü„ÄÇ | r«î guƒÅn w√∫ lƒõi ji√© q√≠n k«î „ÄÇ d√π tu≈ç r√∫ sh√¨ dƒõng n√°n hu√† gƒÅng qi√°ng zu√¨ k«î zh√≤ng shƒìng „ÄÇ | Nh·ªØ quan ng√¥ l≈©y ki·∫øp c·∫ßn kh·ªï. ƒê·ªô tho√°t nh∆∞ th·ªã ƒë·∫≥ng nan h√≥a cang c∆∞·ªùng t·ªôi kh·ªï ch√∫ng sanh. | "You observe that I have worked diligently for aeons to liberate such stubborn living beings who are difficult to transform and who suffer from their offenses." | "√îng xem Ta tr·∫£i qua bao s·ªë ki·∫øp nh·ªçc nh·∫±n, ƒë·ªô tho√°t nh·ªØng ch√∫ng sanh cang c∆∞·ªùng ƒë·∫ßy t·ªôi kh·ªï kh√≥ khai h√≥a nh∆∞ th·∫ø."
[00:03:04] ÂÖ∂ÊúâÊú™Ë∞É‰ºèËÄÖ„ÄÇÈöè‰∏öÊä•Â∫î„ÄÇËã•Â†ïÊÅ∂Ë∂£ÂèóÂ§ßËã¶Êó∂„ÄÇ | q√≠ y«íu w√®i ti√°o f√∫ zhƒõ „ÄÇ su√≠ y√® b√†o y√¨ng „ÄÇ ru√≤ du√≤ √® q√π sh√≤u d√† k«î sh√≠ „ÄÇ | K·ª≥ h·ªØu v·ªã ƒëi·ªÅu ph·ª•c gi·∫£. T√πy nghi·ªáp b√°o ·ª©ng. Nh∆∞·ª£c ƒë·ªça √°c th√∫ th·ªç ƒë·∫°i kh·ªï th·ªùi. | "Those who have not yet been tamed will undergo retributions according to their karma. If they fall into the Evil Paths and endure great suffering..." | "Ngo√†i ra, nh·ªØng k·∫ª ch∆∞a ƒë∆∞·ª£c ƒëi·ªÅu ph·ª•c, th√¨ ph·∫£i theo nghi·ªáp m√† ch·ªãu b√°o ·ª©ng. N·∫øu ch√∫ng n√≥ c√≥ b·ªã ƒë·ªça v√†o ƒë∆∞·ªùng d·ªØ ch·ªãu kh·ªï l·ªõn..."
[00:03:12] Ê±ùÂΩìÂøÜÂøµÂêæÂú®ÂøâÂà©Â§©ÂÆ´„ÄÇÊÆ∑Âã§‰ªòÂò±„ÄÇ‰ª§Â®ëÂ©Ü‰∏ñÁïå„ÄÇËá≥Âº•ÂãíÂá∫‰∏ñ‰ª•Êù•‰ºóÁîü„ÄÇ | r«î dƒÅng y√¨ ni√†n w√∫ z√†i dƒÅo l√¨ tiƒÅn g≈çng „ÄÇ yƒ´n q√≠n f√π zh«î „ÄÇ l√¨ng su≈ç p√≥ sh√¨ ji√® „ÄÇ zh√¨ m√≠ l√® ch≈´ sh√¨ y«ê l√°i zh√≤ng shƒìng „ÄÇ | Nh·ªØ ƒë∆∞∆°ng ·ª©c ni·ªám ng√¥ t·∫°i ƒêao L·ª£i thi√™n cung. √Çn c·∫ßn ph√≥ ch√∫c. Linh Ta B√† th·∫ø gi·ªõi. Ch√≠ Di L·∫∑c xu·∫•t th·∫ø dƒ© lai ch√∫ng sanh. | "...you should remember that I have earnestly entrusted you here in the Palace of the Trayastrimsa Heaven. You must cause all beings in the Saha world, until the time when Maitreya comes into the world..." | "...th·ªùi √¥ng n√™n nh·ªõ nghƒ© ƒë·∫øn l·ªùi Ta ·ªü cung tr·ªùi ƒêao L·ª£i √¢n c·∫ßn ph√≥ ch√∫c ƒë√¢y, m√† ƒë·ªô tho√°t ch√∫ng sanh ·ªü c√µi Ta B√† n√†y ƒë·∫øn l√∫c Ph·∫≠t Di L·∫∑c ra ƒë·ªùi..."
[00:03:22] ÊÇâ‰ΩøËß£ËÑ±„ÄÇÊ∞∏Á¶ªËØ∏Ëã¶„ÄÇÈÅá‰ΩõÊéàËÆ∞„ÄÇ | xƒ´ sh«ê jiƒõ tu≈ç „ÄÇ y«íng l√≠ zh≈´ k«î „ÄÇ y√π f√≥ sh√≤u j√¨ „ÄÇ | T·∫•t s·ª≠ gi·∫£i tho√°t. Vƒ©nh ly ch∆∞ kh·ªï. Ng·ªô Ph·∫≠t th·ªç k√Ω. | "...to be liberated, to leave suffering forever, and to meet Buddhas and receive predictions." | "...ƒë·ªÅu l√†m cho gi·∫£i tho√°t, d·ª©t h·∫≥n c√°c s·ª± kh·ªï, g·∫∑p Ph·∫≠t v√† ƒë∆∞·ª£c th·ªç k√Ω."
[00:03:28] Â∞îÊó∂ËØ∏‰∏ñÁïåÂàÜË∫´Âú∞ËóèËè©Ëê®„ÄÇÂÖ±Â§ç‰∏ÄÂΩ¢„ÄÇÊ∂ïÊ≥™ÂìÄÊÅã„ÄÇÁôΩÂÖ∂‰ΩõË®Ä„ÄÇ | ƒõr sh√≠ zh≈´ sh√¨ ji√® fƒìn shƒìn d√¨ z√†ng p√∫ s√† „ÄÇ g√≤ng f√π yƒ´ x√≠ng „ÄÇ t√¨ l√®i ƒÅi li√†n „ÄÇ b√°i q√≠ f√≥ y√°n „ÄÇ | Nhƒ© th·ªùi ch∆∞ th·∫ø gi·ªõi ph√¢n th√¢n ƒê·ªãa T·∫°ng B·ªì T√°t. C·ªông ph·ª•c nh·∫•t h√¨nh. Th·ªá l·ªá ai luy·∫øn. B·∫°ch k·ª≥ Ph·∫≠t ng√¥n. | At that time, all the division bodies of Earth Store Bodhisattva from all the worlds merged into a single form. Weeping in pity and longing, he said to the Buddha: | B·∫•y gi·ªù, nh·ªØng ph√¢n th√¢n ƒê·ªãa T·∫°ng B·ªì T√°t ·ªü c√°c th·∫ø gi·ªõi h·ª£p l·∫°i m·ªôt h√¨nh, r∆°i l·ªá th∆∞∆°ng c·∫£m m√† b·∫°ch c√πng Ph·∫≠t r·∫±ng:
[00:03:38] Êàë‰ªé‰πÖËøúÂä´Êù•„ÄÇËíô‰ΩõÊé•Âºï„ÄÇ‰ΩøËé∑‰∏çÂèØÊÄùËÆÆÁ•ûÂäõ„ÄÇÂÖ∑Â§ßÊô∫ÊÖß„ÄÇ | w«í c√≥ng ji«î yu«én ji√© l√°i „ÄÇ m√©ng f√≥ jiƒì y«ên „ÄÇ sh«ê hu√≤ b√π kƒõ sƒ´ y√¨ sh√©n l√¨ „ÄÇ j√π d√† zh√¨ hu√¨ „ÄÇ | Ng√£ t√πng c·ª≠u vi·ªÖn ki·∫øp lai. M√¥ng Ph·∫≠t ti·∫øp d·∫´n. S·ª≠ ho·∫°ch b·∫•t kh·∫£ t∆∞ ngh·ªã th·∫ßn l·ª±c. C·ª• ƒë·∫°i tr√≠ hu·ªá. | "From long aeons past, I have received the Buddha's guidance, which has enabled me to obtain inconceivable spiritual power and great wisdom." | "T·ª´ s·ªë ki·∫øp l√¢u xa ƒë·∫øn nay, con nh·ªù ƒë·ª©c Th·∫ø T√¥n ti·∫øp ƒë·ªô d·∫Øt d√¨u l√†m cho con ƒë∆∞·ª£c th·∫ßn l·ª±c ch·∫≥ng th·ªÉ nghƒ© b√†n, ƒë·∫ßy ƒë·ªß tr√≠ hu·ªá r·ªông l·ªõn."
[00:03:46] ÊàëÊâÄÂàÜË∫´„ÄÇÈÅçÊª°ÁôæÂçÉ‰∏á‰∫øÊÅíÊ≤≥Ê≤ô‰∏ñÁïå„ÄÇ | w«í su«í fƒìn shƒìn „ÄÇ bi√†n m«én b«éi qiƒÅn w√†n y√¨ h√©ng h√© shƒÅ sh√¨ ji√® „ÄÇ | Ng√£ s·ªü ph√¢n th√¢n. Bi·∫øn m√£n b√°ch thi√™n v·∫°n ·ª©c H·∫±ng h√† sa th·∫ø gi·ªõi. | "My division bodies fill worlds as many as the grains of sand in hundreds of thousands of millions of Ganges Rivers." | "Con ph√¢n hi·ªán th√¢n h√¨nh ra ·ªü c√πng kh·∫Øp trƒÉm ngh√¨n mu√¥n ·ª©c h·∫±ng h√† sa th·∫ø gi·ªõi."
[00:03:52] ÊØè‰∏Ä‰∏ñÁïåÂåñÁôæÂçÉ‰∏á‰∫øË∫´„ÄÇÊØè‰∏ÄË∫´Â∫¶ÁôæÂçÉ‰∏á‰∫ø‰∫∫„ÄÇ | mƒõi yƒ´ sh√¨ ji√® hu√† b«éi qiƒÅn w√†n y√¨ shƒìn „ÄÇ mƒõi yƒ´ shƒìn d√π b«éi qiƒÅn w√†n y√¨ r√©n „ÄÇ | M·ªói nh·∫•t th·∫ø gi·ªõi h√≥a b√°ch thi√™n v·∫°n ·ª©c th√¢n. M·ªói nh·∫•t th√¢n ƒë·ªô b√°ch thi√™n v·∫°n ·ª©c nh√¢n. | "In each of those worlds, I manifest hundreds of thousands of millions of bodies, and each body crosses over hundreds of thousands of millions of people." | "Trong m·ªói th·∫ø gi·ªõi h√≥a hi·ªán trƒÉm ngh√¨n mu√¥n ·ª©c th√¢n. M·ªói th√¢n ƒë√≥ ƒë·ªô tho√°t trƒÉm ngh√¨n mu√¥n ·ª©c ng∆∞·ªùi..."
[00:03:58] ‰ª§ÂΩíÊï¨‰∏âÂÆù„ÄÇÊ∞∏Á¶ªÁîüÊ≠ª„ÄÇËá≥Ê∂ÖÊßÉ‰πê„ÄÇ | l√¨ng guƒ´ j√¨ng sƒÅn b«éo „ÄÇ y«íng l√≠ shƒìng s«ê „ÄÇ zh√¨ ni√® p√°n l√® „ÄÇ | Linh quy k√≠nh Tam B·∫£o. Vƒ©nh ly sanh t·ª≠. Ch√≠ Ni·∫øt B√†n l·∫°c. | "I cause them to return to and respect the Triple Jewel, to leave birth and death forever, and to reach the bliss of Nirvana." | "...l√†m cho quy y k√≠nh tr·ªçng Tam B·∫£o, kh·ªèi h·∫≥n v√≤ng sanh t·ª≠, h∆∞·ªüng vui Ni·∫øt B√†n."
[00:04:04] ‰ΩÜ‰∫é‰ΩõÊ≥ï‰∏≠ÊâÄ‰∏∫ÂñÑ‰∫ã„ÄÇ‰∏ÄÊØõ‰∏ÄÊ∏ß„ÄÇ‰∏ÄÊ≤ô‰∏ÄÂ∞ò„ÄÇÊàñÊØ´ÂèëËÆ∏„ÄÇ | d√†n y√∫ f√≥ f«é zh≈çng su«í w√©i sh√†n sh√¨ „ÄÇ yƒ´ m√°o yƒ´ dƒ´ „ÄÇ yƒ´ shƒÅ yƒ´ ch√©n „ÄÇ hu√≤ h√°o f√† x«î „ÄÇ | ƒê√£n ∆∞ Ph·∫≠t Ph√°p trung s·ªü vi thi·ªán s·ª±. Nh·∫•t mao nh·∫•t ƒë·∫ø. Nh·∫•t sa nh·∫•t tr·∫ßn. Ho·∫∑c h√†o ph√°t h·ª©a. | "Even if they perform good deeds within the Buddha Dharma as small as a strand of hair, a drop of water, a grain of sand, a mote of dust, or a hair's breadth..." | "Nh·ªØng ch√∫ng sanh n√†o ·ªü trong Ph·∫≠t Ph√°p, ch·ªâ l√†m vi·ªác l√†nh ch·ª´ng b·∫±ng m·ªôt s·ª£i l√¥ng, m·ªôt gi·ªçt n∆∞·ªõc, m·ªôt h·ªôt c√°t, m·ªôt b·ª•i nh·ªè, ho·∫∑c ch·ªâ ch·ª´ng b·∫±ng m·∫£y l√¥ng t√≥c..."
[00:04:13] ÊàëÊ∏êÂ∫¶ËÑ±„ÄÇ‰ΩøËé∑Â§ßÂà©„ÄÇÂîØÊÑø‰∏ñÂ∞ä„ÄÇ‰∏ç‰ª•Âêé‰∏ñÊÅ∂‰∏ö‰ºóÁîü‰∏∫Ëôë„ÄÇ | w«í ji√†n d√π tu≈ç „ÄÇ sh«ê hu√≤ d√† l√¨ „ÄÇ w√©i yu√†n sh√¨ z≈´n „ÄÇ b√π y«ê h√≤u sh√¨ √® y√® zh√≤ng shƒìng w√©i l«ú „ÄÇ | Ng√£ ti·ªám ƒë·ªô tho√°t. S·ª≠ ho·∫°ch ƒë·∫°i l·ª£i. Duy nguy·ªán Th·∫ø T√¥n. B·∫•t dƒ© h·∫≠u th·∫ø √°c nghi·ªáp ch√∫ng sanh vi l·ª±. | "...I will gradually cross them over and cause them to obtain great benefits. I only pray that the World Honored One will not be concerned about living beings of the future with evil karma." | "...con ƒë·ªÅu ƒë·ªô tho√°t l·∫ßn l·∫ßn, l√†m cho ch√∫ng ƒë√≥ ƒë∆∞·ª£c l·ª£i √≠ch l·ªõn. C√∫i mong ƒë·ª©c Nh∆∞ Lai ch·ªõ v√¨ nh·ªØng ch√∫ng sanh √°c nghi·ªáp ƒë·ªùi sau m√† sanh l√≤ng lo l·∫Øng."
[00:04:22] Â¶ÇÊòØ‰∏âÁôΩ‰ΩõË®Ä„ÄÇÂîØÊÑø‰∏ñÂ∞ä„ÄÇ‰∏ç‰ª•Âêé‰∏ñÊÅ∂‰∏ö‰ºóÁîü‰∏∫Ëôë„ÄÇ | r√∫ sh√¨ sƒÅn b√°i f√≥ y√°n „ÄÇ w√©i yu√†n sh√¨ z≈´n „ÄÇ b√π y«ê h√≤u sh√¨ √® y√® zh√≤ng shƒìng w√©i l«ú „ÄÇ | Nh∆∞ th·ªã tam b·∫°ch Ph·∫≠t ng√¥n. Duy nguy·ªán Th·∫ø T√¥n. B·∫•t dƒ© h·∫≠u th·∫ø √°c nghi·ªáp ch√∫ng sanh vi l·ª±. | He said this to the Buddha three times: "I only pray that the World Honored One will not be concerned about living beings of the future with evil karma." | C√∫i mong ƒë·ª©c Nh∆∞ Lai ch·ªõ v√¨ nh·ªØng ch√∫ng sanh √°c nghi·ªáp ƒë·ªùi sau m√† sanh l√≤ng lo l·∫Øng. Ng√†i ƒê·ªãa T·∫°ng b·∫°ch c√πng Ph·∫≠t ba l·∫ßn nh∆∞ th·∫ø.
[00:04:30] Â∞îÊó∂‰ΩõËµûÂú∞ËóèËè©Ëê®Ë®Ä„ÄÇÂñÑÂìâÂñÑÂìâ„ÄÇÂêæÂä©Ê±ùÂñú„ÄÇ | ƒõr sh√≠ f√≥ z√†n d√¨ z√†ng p√∫ s√† y√°n „ÄÇ sh√†n zƒÅi sh√†n zƒÅi „ÄÇ w√∫ zh√π r«î x«ê „ÄÇ | Nhƒ© th·ªùi Ph·∫≠t t√°n ƒê·ªãa T·∫°ng B·ªì T√°t ng√¥n. Thi·ªán tai thi·ªán tai. Ng√¥ tr·ª£ nh·ªØ h·ª∑. | At that time, the Buddha praised Earth Store Bodhisattva, saying: "Excellent, excellent! I will help you in your work." | L√∫c ·∫•y, ƒë·ª©c Ph·∫≠t khen Ng√†i ƒê·ªãa T·∫°ng B·ªì T√°t r·∫±ng: "Hay thay! Hay thay! Ta h·ªô tr·ª£ cho √¥ng ƒë∆∞·ª£c to·∫°i √Ω".
[00:04:37] Ê±ùËÉΩÊàêÂ∞±‰πÖËøúÂä´Êù•„ÄÇÂèëÂºòË™ìÊÑø„ÄÇÂπøÂ∫¶Â∞ÜÊØï„ÄÇÂç≥ËØÅËè©Êèê„ÄÇ | r«î n√©ng ch√©ng ji√π ji«î yu«én ji√© l√°i „ÄÇ fƒÅ h√≥ng sh√¨ yu√†n „ÄÇ gu«éng d√π jiƒÅng b√¨ „ÄÇ j√≠ zh√®ng p√∫ t√≠ „ÄÇ | Nh·ªØ nƒÉng th√†nh t·ª±u c·ª≠u vi·ªÖn ki·∫øp lai. Ph√°t ho·∫±ng th·ªá nguy·ªán. Qu·∫£ng ƒë·ªô t∆∞∆°ng t·∫•t. T·ª©c ch·ª©ng B·ªì ƒê·ªÅ. | "You will be able to fulfill the vast vows you have made throughout long aeons. When your vast crossing over is nearly complete, you will immediately verify Bodhi." | "T·ª´ l·ª©c √¥ng ƒë·∫°t th√†nh nh·ªØng nguy·ªán l·ªõn ƒë√£ l·∫≠p ra bao nhi√™u ki·∫øp l√¢u xa ƒë·∫øn nay, qu·∫£ng ƒë·ªô ch√∫ng sanh xong r·ªìi, th·ªùi √¥ng li·ªÅn ch·ª©ng qu·∫£ B·ªì ƒê·ªÅ".
`;

        // --- TAM THIEN TU DATA (Sample ~3000 Common Characters) ---
        const tamThienTuStr = "Â§©Âú∞‰∏æÂ≠òÂ≠êÂ≠ôÂÖ≠‰∏âÂÆ∂ÂõΩÂâçÂêéÁâõÈ©¨Ë∑ùÁâôÊó†ÊúâÁä¨ÁæäÂΩíËµ∞ÊãúË∑™ÂéªÊù•Â•≥Áî∑Â∏¶ÂÜ†Ë∂≥Â§öÁà±ÊÜéËØÜÁü•Êú®Ê†πÊòìÈöæÊó®ÁîòÊü±Ê¢ÅÂ∫äÂ∏≠Ê¨†‰ΩôÈîÑÈû†ÁÉõÁÅØÂçáÈôçÁî∞ÂÆÖËÄÅÁ´•ÈõÄÈ∏°Êàë‰ªñ‰ºØÂß®ÈìÖÈî°ÂΩπÂäüÁø∞ÁøºÂú£Ë¥§‰ªô‰ΩõÊΩ¶ÊΩÆÈ∏¢Âá§‰∏àÂØªÁõòÁõèËåß‰∏ùÊ¢ÖÊùéÊªìÊ∏ÖËÉ∏ËáÜÂ¢®Êú±Â®áÁÜüÊÖéÂªâÁßÅÊÖïËá≥Âõû‰π°Â∏ÇÂ¶áÂ§´ÂÜÖ‰∏≠Èó®Â±ãËã±ËíÇËè≤Ëë±ËãçÁôΩËã¶ÈÖ∏È©∫È©æÁü≥ÈáëÈü≥‰ø°Âê¨ÈóªÈ∏üÂÖΩÁæΩÊØõÁöÆËßíÁî≤È≥ûË°åÈ£ûÊΩúÊ≥≥ÈæôËôéÈæüÈ∫üÂçµËÉéÂåñÊπøÂΩ¢‰ΩìÈù¢Á•ûÈ¢êÁõÆÂè£ÂîáËàåÈΩøËÄ≥ÈºªÂñâÈ¢úÈ¨ìÁúâÂèëÂ§¥È¶ñËÑëÈ¢ùÈ°∂È¢êÈ¢îÈ°πÈ¢àËÇ©ËÉåËÜÇËÉÅËÖãËÖïËÇ±ËáÇÊâãÊéåÊåáÁî≤ËÑöËÖøËÜùËÉ´Ë∏ùË∏µË∂æË∫´Ë∫ØÈ™®ËÇâÈ´ìËÑëË°ÄËÑâÁ≠ãÁöÆËÇ†ËÉÉÂøÉËÇùËÑæËÇ∫ËÇæËÉÜËÉûËÉéÁ≤æÊ∞îÁ•ûÈ≠ÇÈ≠ÑÂøóÊÑèÂøµÊÉ≥ÊÄùËôëÂøßÊÑÅÂñúÊÄíÂìÄ‰πêÊÅêÊÉäÊÇ≤Ê¨¢ËÅ™ÊòéÊô∫ÊÖßÊÑöÁó¥ÊöóÈíùÊâçËâ∫ÊäÄËÉΩÂ∑•Â∑ßÁôæÂ∑•Â£´ÂÜúÂ∑•ÂïÜÂêõËá£Áà∂Â≠êÂ§´Â¶áÂÖÑÂºüÊúãÂèãÂÆæ‰∏ªÂ∏àÁîü‰∏ª‰ªÜÂ•¥Â©¢ÂÆòÂêèÂÖµÂçíÂ∞ÜÂ∏ÖÂÜõÊóÖÁî≤ËÉÑÂºìÁü¢ÂàÄÂâëÁüõÁõæÊóåÊóóÈºìÈí≤ËΩ¶ËàπËàüÊ•´Â∏ÜÊ®ØÊ©πÊ£πÊ°•Ê¢ÅÈÅìË∑ØË°óÂ∑∑ÂüéÈÉ≠ÂÆ´ÂÆ§ÊÆøÂ†Ç‰∫≠Âè∞Ê•ºÈòÅÂõ≠ÊûóÊ±†Ê≤ºÈôÇÂ°ò‰∫ïÁÅ∂ÈáúÁîëÁ¢óÁ¢üÊùØÁõòÂåôÁÆ∏Â£∂ËßûÂ∞äÁàµÂá†Ê°àÁÆ±ÁÆßÂõäÊ©êË°£Ë£≥ÂÜ†ÂÜïÈûãË¢úÁ∞™Áè•Áí∞ÈíèÈî¶Áª£ÁΩóÁªÆÂ∏ÉÂ∏õ‰∏ùÈ∫ªÊ£âÁµÆË£ÅÁºùÁ∫∫ÁªáËÄïÁ®ºÁßçÊ§çÊî∂Ëé∑‰ªìÂª™Â∫úÂ∫ìÈí±Ë¥¢Ë¥ßË¥øË¥∏Êòì‰π∞ÂçñÁß§Â∞∫ÊñóÊñõÊñ§‰∏§Èí±ÂàÜÈì¢ÂØ∏‰∏àÂØªÂ∏∏ÊØ´ÂéòÂú≠ÊíÆÊï∞ÁÆóÂä†Âáè‰πòÈô§Âπ¥ÊúàÊó•Êó∂Êò•Â§èÁßãÂÜ¨ÂØíÊöëÂÜ∑ÁÉ≠È£é‰∫ëÈõ®Èõ™Èõ∑ÁîµÈúúÈú≤ÈúûÈõæËôπÈúìÊòüËæ∞Êó•ÊúàÈò¥Èò≥‰πæÂù§ÂÆáÂÆô‰∏ñÁïåÂ±±Â∑ùÊ±üÊ≤≥ÊπñÊµ∑ÈôµÈôÜÈ´òÂéüÂπ≥ÂéüËçâÊú®Ëä±ÊûúÁ´πËãáÊùæÊüèÊ°ëÈ∫ªÁ®ªÁ≤±È∫¶Ë±ÜÈªçÁ®∑Á¶ΩÂÖΩËô´È±ºÈ£ûËµ∞ÊΩú‰ºèÂä®Ê§çÁüøÁâ©ÈáëÈì∂ÈìúÈìÅÈìÖÈî°Áè†ÁéâÂÆùÁü≥ÁêâÁíÉÁèäÁëöÁéõÁëôÁê•ÁèÄÁèçÁè†Ë±°ÁâôÁäÄËßíÈ∫ùÈ¶ôÁâõÈªÑËôéÈ™®ÈπøËå∏ÁÜäËÉÜÈæüÊùøÈ≥ñÁî≤ËùâËúïËõáÁöÆËúÇÊàøËöïÁ†ÇÁ∫¢ÈªÑËìùÁôΩÈªëÁ¥´ÁªøÈùíËµ§Ê©ôÁÅ∞Ë§êÊñπÂúÜÈïøÁü≠È´ò‰ΩéÂ§ßÂ∞èÂéöËñÑÂπøÁã≠Ê∑±ÊµÖËøúËøëËΩªÈáçÊÄ•ÁºìÂø´ÊÖ¢Â•ΩÂùèÂñÑÊÅ∂Áæé‰∏ëÊòØÈùûÁúüÂÅáËôöÂÆûÊúâÊó†ÂæóÂ§±ÊàêË¥•ÂÖ¥‰∫°ÁõõË°∞Ê≤ª‰π±ÂÆâÂç±ÂêâÂá∂Á•∏Á¶èÂØøÂ§≠Ë¥´ÂØåË¥µË¥±Â∞äÂçë‰∏ä‰∏ãÂ∑¶Âè≥ÂÜÖÂ§ñ‰∏≠Èó¥‰∏úË•øÂçóÂåóÂõõÊñπÂÖ´Èù¢Âè§‰ªäÂæÄÊù•ÂÆáÂÆôÊ¥™ËçíÁéÑÈªÑÊó•ÊúàÁõàÊòÉËæ∞ÂÆøÂàóÂº†ÂØíÊù•ÊöëÂæÄÁßãÊî∂ÂÜ¨ËóèÈó∞‰ΩôÊàêÂ≤ÅÂæãÂêïË∞ÉÈò≥‰∫ëËÖæËá¥Èõ®Èú≤Áªì‰∏∫ÈúúÈáëÁîü‰∏ΩÊ∞¥ÁéâÂá∫ÊòÜÂÜàÂâëÂè∑Â∑®ÈòôÁè†Áß∞Â§úÂÖâÊûúÁèçÊùéÊü∞ËèúÈáçËä•ÂßúÊµ∑Âí∏Ê≤≥Ê∑°È≥ûÊΩúÁæΩÁøîÈæôÂ∏àÁÅ´Â∏ùÈ∏üÂÆò‰∫∫ÁöáÂßãÂà∂ÊñáÂ≠ó‰πÉÊúçË°£Ë£≥Êé®‰ΩçËÆ©ÂõΩÊúâËôûÈô∂ÂîêÂêäÊ∞ë‰ºêÁΩ™Âë®ÂèëÊÆ∑Ê±§ÂùêÊúùÈóÆÈÅìÂûÇÊã±Âπ≥Á´†Áà±ËÇ≤ÈªéÈ¶ñËá£‰ºèÊàéÁæåÈÅêËø©‰∏Ä‰ΩìÁéáÂÆæÂΩíÁéãÈ∏£Âá§Âú®Á´πÁôΩÈ©πÈ£üÂú∫ÂåñË¢´ËçâÊú®ËµñÂèä‰∏áÊñπÁõñÊ≠§Ë∫´ÂèëÂõõÂ§ß‰∫îÂ∏∏ÊÅ≠ÊÉüÈû†ÂÖªÂ≤ÇÊï¢ÊØÅ‰º§Â•≥ÊÖïË¥ûÊ¥ÅÁî∑ÊïàÊâçËâØÁü•ËøáÂøÖÊîπÂæóËÉΩËé´ÂøòÁΩîË∞àÂΩºÁü≠Èù°ÊÅÉÂ∑±Èïø‰ø°‰ΩøÂèØË¶ÜÂô®Ê¨≤ÈöæÈáèÂ¢®ÊÇ≤‰∏ùÊüìËØóËµûÁæîÁæäÊôØË°åÁª¥Ë¥§ÂÖãÂøµ‰ΩúÂú£Âæ∑Âª∫ÂêçÁ´ãÂΩ¢Á´ØË°®Ê≠£Á©∫Ë∞∑‰º†Â£∞ËôöÂ†Ç‰π†Âê¨Á•∏Âõ†ÊÅ∂ÁßØÁ¶èÁºòÂñÑÂ∫ÜÂ∞∫ÁíßÈùûÂÆùÂØ∏Èò¥ÊòØÁ´ûËµÑÁà∂‰∫ãÂêõÊõ∞‰∏•‰∏éÊï¨Â≠ùÂΩìÁ´≠ÂäõÂø†ÂàôÂ∞ΩÂëΩ‰∏¥Ê∑±Â±•ËñÑÂ§ôÂÖ¥Ê∏©Ê∏Ö‰ººÂÖ∞ÊñØÈ¶®Â¶ÇÊùæ‰πãÁõõÂ∑ùÊµÅ‰∏çÊÅØÊ∏äÊæÑÂèñÊò†ÂÆπÊ≠¢Ëã•ÊÄùË®ÄËæûÂÆâÂÆöÁ¨ÉÂàùËØöÁæéÊÖéÁªàÂÆú‰ª§Ëç£‰∏öÊâÄÂü∫Á±çÁîöÊó†Á´üÂ≠¶‰ºòÁôª‰ªïÊëÑËÅå‰ªéÊîøÂ≠ò‰ª•ÁîòÊ£†ÂéªËÄåÁõäÂíè‰πêÊÆäË¥µË¥±Á§ºÂà´Â∞äÂçë‰∏äÂíå‰∏ãÁù¶Â§´Âî±Â¶áÈöèÂ§ñÂèóÂÇÖËÆ≠ÂÖ•Â•âÊØç‰ª™ËØ∏Âßë‰ºØÂèîÁäπÂ≠êÊØîÂÑøÂ≠îÊÄÄÂÖÑÂºüÂêåÊ∞îËøûÊûù‰∫§ÂèãÊäïÂàÜÂàáÁ£®ÁÆ¥ËßÑ‰ªÅÊÖàÈöêÊÅªÈÄ†Ê¨°ÂºóÁ¶ªËäÇ‰πâÂªâÈÄÄÈ¢†Ê≤õÂå™‰∫èÊÄßÈùôÊÉÖÈÄ∏ÂøÉÂä®Á•ûÁñ≤ÂÆàÁúüÂøóÊª°ÈÄêÁâ©ÊÑèÁßªÂùöÊåÅÈõÖÊìçÂ•ΩÁàµËá™Á∏ªÈÉΩÈÇëÂçéÂ§è‰∏úË•ø‰∫å‰∫¨ËÉåÈÇôÈù¢Ê¥õÊµÆÊ∏≠ÊçÆÊ≥æÂÆ´ÊÆøÁõòÈÉÅÊ•ºËßÇÈ£ûÊÉäÂõæÂÜôÁ¶ΩÂÖΩÁîªÂΩ©‰ªôÁÅµ‰∏ôËàçÂÇçÂêØÁî≤Â∏êÂØπÊ•πËÇÜÁ≠µËÆæÂ∏≠ÈºìÁëüÂêπÁ¨ôÂçáÈò∂Á∫≥ÈôõÂºÅËΩ¨ÁñëÊòüÂè≥ÈÄöÂπøÂÜÖÂ∑¶ËææÊâøÊòéÊó¢ÈõÜÂùüÂÖ∏‰∫¶ËÅöÁæ§Ëã±ÊùúÁ®øÈíüÈö∂ÊºÜ‰π¶Â£ÅÁªèÂ∫úÁΩóÂ∞ÜÁõ∏Ë∑Ø‰æ†ÊßêÂçøÊà∑Â∞ÅÂÖ´ÂéøÂÆ∂ÁªôÂçÉÂÖµÈ´òÂÜ†Èô™ËæáÈ©±ÊØÇÊåØÁº®‰∏ñÁ¶Ñ‰æàÂØåËΩ¶È©æËÇ•ËΩªÁ≠ñÂäüËåÇÂÆûÂãíÁ¢ëÂàªÈì≠Á£ªÊ∫™‰ºäÂ∞π‰ΩêÊó∂ÈòøË°°Â•ÑÂÆÖÊõ≤ÈòúÂæÆÊó¶Â≠∞Ëê•Ê°ìÂÖ¨Âå°ÂêàÊµéÂº±Êâ∂ÂÄæÁªÆÂõûÊ±âÊÉ†ËØ¥ÊÑüÊ≠¶‰∏Å‰øä‰πÇÂØÜÂãøÂ§öÂ£´ÂØîÂÆÅÊôãÊ•öÊõ¥Èú∏ËµµÈ≠èÂõ∞Ê®™ÂÅáÈÄîÁÅ≠ÂüüË∑µÂúü‰ºöÁõü‰ΩïÈÅµÁ∫¶Ê≥ïÈü©ÂºäÁÉ¶ÂàëËµ∑Áø¶È¢áÁâßÁî®ÂÜõÊúÄÁ≤æÂÆ£Â®ÅÊ≤ôÊº†È©∞Ë™â‰∏πÈùí‰πùÂ∑ûÁ¶πËøπÁôæÈÉ°Áß¶Âπ∂Â≤≥ÂÆóÊ≥∞Â≤±Á¶Ö‰∏ª‰∫ë‰∫≠ÈõÅÈó®Á¥´Â°ûÈ∏°Áî∞Ëµ§ÂüéÊòÜÊ±†Á¢£Áü≥Â∑®ÈáéÊ¥ûÂ∫≠Êó∑ËøúÁªµÈÇàÂ≤©Â≤´Êù≥ÂÜ•Ê≤ªÊú¨‰∫éÂÜúÂä°ÂÖπÁ®ºÁ©ë‰ø∂ËΩΩÂçó‰∫©ÊàëËâ∫ÈªçÁ®∑Á®éÁÜüË¥°Êñ∞ÂäùËµèÈªúÈôüÂ≠üËΩ≤Êï¶Á¥†Âè≤È±ºÁßâÁõ¥Â∫∂Âá†‰∏≠Â∫∏Âä≥Ë∞¶Ë∞®ÊïïËÅÜÈü≥ÂØüÁêÜÈâ¥Ë≤åËæ®Ëâ≤Ë¥ªÂé•ÂòâÁå∑ÂãâÂÖ∂Á•óÊ§çÁúÅË∫¨ËÆ•ËØ´ÂÆ†Â¢ûÊäóÊûÅÊÆÜËæ±ËøëËÄªÊûóÁöãÂπ∏Âç≥‰∏§ÁñèËßÅÊú∫Ëß£ÁªÑË∞ÅÈÄºÁ¥¢Â±ÖÈó≤Â§ÑÊ≤âÈªòÂØÇÂØ•Ê±ÇÂè§ÂØªËÆ∫Êï£ËôëÈÄçÈÅ•Ê¨£Â•èÁ¥ØÈÅ£ÊàöË∞¢Ê¨¢ÊãõÊ∏†Ëç∑ÁöÑÂéÜÂõ≠ËéΩÊäΩÊù°ÊûáÊù∑ÊôöÁø†Ê¢ßÊ°êÊó©ÂáãÈôàÊ†πÂßîÁø≥ËêΩÂè∂È£òÊëáÊ∏∏ÈπçÁã¨ËøêÂáåÊë©ÁªõÈúÑ";
        
        const tamThienTuSet = new Set(tamThienTuStr);

        // --- APP STATE ---
        let transcripts = [];
        let simulationInterval = null;
        let isPlaying = false;
        let currentSimulationTime = 0; 
        const simulationSpeed = 1; 
        let analysisMode = false;
        let vocabChartInstance = null;

        // --- CORE FUNCTIONS ---

        // 1. Text-to-Speech Functionality (iOS Optimized)
        
        // GLOBAL VARIABLE to prevent iOS Safari Garbage Collection (Critical Fix)
        window.currentUtterance = null; 
        let availableVoices = [];

        function loadVoices() {
            if ('speechSynthesis' in window) {
                availableVoices = window.speechSynthesis.getVoices();
            }
        }
        
        // Initialize voices (Chrome loads immediately, iOS waits for event)
        if ('speechSynthesis' in window) {
            loadVoices();
            window.speechSynthesis.onvoiceschanged = loadVoices;
        }

        function speakText(text, btnId) {
            if ('speechSynthesis' in window) {
                // Cancel current speech if any to avoid queue backup
                window.speechSynthesis.cancel();
                
                // Visual feedback
                if(btnId) {
                    document.querySelectorAll('.speaking-active').forEach(el => el.classList.remove('speaking-active'));
                    const btn = document.getElementById(btnId);
                    if(btn) btn.classList.add('speaking-active');
                }

                // Create Utterance
                const utterance = new SpeechSynthesisUtterance(text);
                
                // --- iOS FIX: EXPLICITLY FIND CHINESE VOICE ---
                // iOS sometimes ignores 'lang' property if voice is not set explicitly
                if (availableVoices.length === 0) {
                    availableVoices = window.speechSynthesis.getVoices();
                }
                
                const zhVoice = availableVoices.find(v => v.lang === 'zh-CN') || 
                                availableVoices.find(v => v.lang.startsWith('zh'));
                
                if (zhVoice) {
                    utterance.voice = zhVoice;
                    utterance.lang = zhVoice.lang;
                } else {
                    utterance.lang = 'zh-CN'; // Fallback
                }
                
                utterance.rate = 0.8; // Slower rate for learning
                
                // --- iOS FIX: PREVENT GARBAGE COLLECTION ---
                // Assign to global variable so Safari doesn't kill it mid-speech
                window.currentUtterance = utterance;

                utterance.onend = function() {
                    if(btnId) {
                        const btn = document.getElementById(btnId);
                        if(btn) btn.classList.remove('speaking-active');
                    }
                    window.currentUtterance = null; // Clean up
                };

                utterance.onerror = function(e) {
                    console.error("Speech Error:", e);
                    if(btnId) {
                        const btn = document.getElementById(btnId);
                        if(btn) btn.classList.remove('speaking-active');
                    }
                    // Silent retry logic could go here, but avoiding infinite loops
                };

                window.speechSynthesis.speak(utterance);
            } else {
                alert("Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ƒë·ªçc √¢m thanh (Text-to-Speech). Vui l√≤ng th·ª≠ tr√™n Chrome, Edge ho·∫∑c Safari m·ªõi nh·∫•t.");
            }
        }

        // 2. Parse Data
        function parseSubtitles(raw) {
            const lines = raw.trim().split('\n');
            const parsed = [];
            // Regex captures: 1=HH, 2=MM, 3=SS, 4=Chinese, 5=Pinyin, 6=Viet (Han), 7=English, 8=Viet (Trans)
            const regex = /\[(\d{2}):(\d{2}):(\d{2})\]\s*(.*?)\s*\|\s*(.*?)\s*\|\s*(.*?)\s*\|\s*(.*?)\s*\|\s*(.*)/;

            lines.forEach((line, index) => {
                const match = line.match(regex);
                if (match) {
                    const hours = parseInt(match[1]);
                    const minutes = parseInt(match[2]);
                    const seconds = parseInt(match[3]);
                    const cnText = match[4].trim();
                    const pinyinText = match[5].trim();
                    const vietHanText = match[6].trim();
                    const enText = match[7].trim();
                    const vietTransText = match[8].trim();
                    const totalSeconds = hours * 3600 + minutes * 60 + seconds;
                    
                    parsed.push({
                        id: index,
                        timeFormatted: `${hours > 0 ? match[1] + ':' : ''}${match[2]}:${match[3]}`,
                        seconds: totalSeconds,
                        cn: cnText,
                        pinyin: pinyinText,
                        vietHan: vietHanText,
                        en: enText,
                        vietTrans: vietTransText,
                        // Search text combined
                        searchText: (cnText + ' ' + pinyinText + ' ' + vietHanText + ' ' + enText + ' ' + vietTransText).toLowerCase()
                    });
                }
            });
            return parsed;
        }

        // 3. Analyze Vocabulary (unchanged logic)
        function analyzeVocabulary(items) {
            const allChars = new Set();
            items.forEach(item => {
                const chars = item.cn.match(/[\u4e00-\u9fa5]/g);
                if (chars) chars.forEach(c => allChars.add(c));
            });

            let inCount = 0;
            let outCount = 0;
            const total = allChars.size;

            allChars.forEach(char => {
                if (tamThienTuSet.has(char)) inCount++;
                else outCount++;
            });

            const inPerc = total > 0 ? Math.round((inCount / total) * 100) : 0;
            const outPerc = total > 0 ? 100 - inPerc : 0;

            document.getElementById('uniqueCharCount').textContent = total;
            document.getElementById('inTTTCount').textContent = inCount;
            document.getElementById('inTTTPerc').textContent = `${inPerc}%`;
            document.getElementById('outTTTCount').textContent = outCount;
            document.getElementById('outTTTPerc').textContent = `${outPerc}%`;

            const commentEl = document.getElementById('analysisComment');
            if (inPerc > 80) commentEl.textContent = `VƒÉn b·∫£n s·ª≠ d·ª•ng ph·∫ßn l·ªõn l√† c√°c ch·ªØ cƒÉn b·∫£n (${inPerc}%), cho th·∫•y ng√¥n ng·ªØ kinh ƒëi·ªÉn kh√° g·∫ßn g≈©i v√† d·ªÖ ti·∫øp c·∫≠n v·ªõi ng∆∞·ªùi c√≥ v·ªën H√°n ng·ªØ c∆° s·ªü.`;
            else if (inPerc > 50) commentEl.textContent = `VƒÉn b·∫£n c√≥ s·ª± k·∫øt h·ª£p c√¢n b·∫±ng gi·ªØa t·ª´ v·ª±ng cƒÉn b·∫£n v√† thu·∫≠t ng·ªØ chuy√™n s√¢u.`;
            else commentEl.textContent = `VƒÉn b·∫£n ch·ª©a nhi·ªÅu thu·∫≠t ng·ªØ chuy√™n m√¥n ho·∫∑c ch·ªØ hi·∫øm g·∫∑p, c·∫ßn tra c·ª©u k·ªπ.`;

            renderVocabChart(inCount, outCount);
        }

        function renderVocabChart(inCount, outCount) {
            const ctx = document.getElementById('vocabChart').getContext('2d');
            if(vocabChartInstance) vocabChartInstance.destroy();
            
            // Determine if dark mode is active (by checking body bg color)
            const isDark = getComputedStyle(document.body).backgroundColor === 'rgb(28, 25, 23)'; // Stone 900
            const textColor = isDark ? '#e7e5e4' : '#44403c';

            vocabChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Trong Tam Thi√™n T·ª±', 'Ngo√†i danh s√°ch'],
                    datasets: [{
                        data: [inCount, outCount],
                        backgroundColor: ['#22c55e', '#f59e0b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom', 
                            labels: { 
                                usePointStyle: true, 
                                font: { family: "'Noto Sans', sans-serif" },
                                color: textColor
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const val = context.raw;
                                    const total = context.chart._metasets[context.datasetIndex].total;
                                    const perc = Math.round((val/total)*100) + '%';
                                    return ` ${context.label}: ${val} (${perc})`;
                                }
                            }
                        }
                    },
                    cutout: '70%'
                }
            });
        }

        // 4. Render List (Updated with Audio Button)
        function renderList(items) {
            const container = document.getElementById('transcriptContainer');
            container.innerHTML = '';
            
            if (items.length === 0) {
                container.innerHTML = '<div class="p-8 text-center text-stone-500 flex flex-col items-center gap-2"><span class="text-2xl">üì≠</span><span>Kh√¥ng t√¨m th·∫•y n·ªôi dung ph√π h·ª£p.</span></div>';
                document.getElementById('visibleCount').textContent = '0 c√¢u';
                return;
            }

            items.forEach((item, index) => {
                const div = document.createElement('div');
                div.id = `line-${item.id}`;
                div.className = 'transcript-item p-4 rounded-lg cursor-pointer mb-2';
                div.onclick = () => jumpToTime(item.seconds);
                
                let processedCn = item.cn;
                if (analysisMode) {
                    processedCn = item.cn.split('').map(char => {
                        if (/[\u4e00-\u9fa5]/.test(char)) {
                            if (tamThienTuSet.has(char)) {
                                return `<span class="char-basic" title="C√≥ trong Tam Thi√™n T·ª±">${char}</span>`;
                            } else {
                                return `<span class="char-advanced" title="Kh√¥ng c√≥ trong danh s√°ch">${char}</span>`;
                            }
                        }
                        return char;
                    }).join('');
                }

                // Add Audio Button (Stop propagation to prevent jump when clicking audio)
                // Note: We send Chinese text (item.cn) to the TTS engine because engines pronounce Hanzi correctly as Pinyin.
                div.innerHTML = `
                    <div class="flex gap-4 items-start relative pr-8">
                        <span class="text-xs font-mono text-amber-500 bg-amber-900/30 px-2 py-1 rounded h-fit shrink-0 mt-2 border border-amber-800/50">${item.timeFormatted}</span>
                        <div class="flex-1 space-y-1">
                            <div class="cn-text text-xl">${processedCn}</div>
                            <div class="pinyin-text">${item.pinyin}</div>
                            <div class="viet-han-text">${item.vietHan}</div>
                            <div class="viet-trans-text">${item.vietTrans}</div>
                            <div class="en-text">${item.en}</div>
                        </div>
                        <button id="audio-btn-${item.id}" 
                                onclick="event.stopPropagation(); speakText('${item.cn.replace(/'/g, "\\'")}', 'audio-btn-${item.id}')" 
                                class="absolute right-0 top-2 text-stone-600 hover:text-amber-500 transition-all p-2 rounded-full hover:bg-stone-700/50 audio-btn" 
                                title="Nghe ƒë·ªçc Pinyin">
                            üîä
                        </button>
                    </div>
                `;
                container.appendChild(div);
            });
            
            document.getElementById('visibleCount').textContent = `${items.length} c√¢u`;
        }

        // 5. Initialize Stats & Jump
        function initJumpSelect(data) {
            const select = document.getElementById('jumpSelect');
            if(data.length === 0) return;
            const totalMinutes = Math.ceil(data[data.length - 1].seconds / 60);
            select.innerHTML = '<option value="0">00:00 - Kh·ªüi ƒë·∫ßu</option>';
            for(let i = 1; i <= totalMinutes; i++) {
                const option = document.createElement('option');
                option.value = i * 60;
                option.textContent = `${i < 10 ? '0'+i : i}:00`;
                select.appendChild(option);
            }
            select.addEventListener('change', (e) => jumpToTime(parseInt(e.target.value)));
        }

        // 6. Simulation Logic
        function jumpToTime(seconds) {
            currentSimulationTime = seconds;
            updateTimeDisplay(currentSimulationTime);
            highlightCurrentLine();
            scrollToActive();
        }
        function updateTimeDisplay(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;
            const formatted = `${h > 0 ? h + ':' : ''}${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
            document.getElementById('currentTimeDisplay').textContent = formatted;
        }
        function highlightCurrentLine() {
            let activeItem = null;
            for (let i = transcripts.length - 1; i >= 0; i--) {
                if (transcripts[i].seconds <= currentSimulationTime) {
                    activeItem = transcripts[i];
                    break;
                }
            }
            
            // Check if active item changed
            const currentActive = document.querySelector('.active-line');
            const newActiveId = activeItem ? `line-${activeItem.id}` : null;
            
            if (currentActive && currentActive.id !== newActiveId) {
                currentActive.classList.remove('active-line');
            }

            if (activeItem && (!currentActive || currentActive.id !== newActiveId)) {
                const el = document.getElementById(newActiveId);
                if (el) {
                    el.classList.add('active-line');
                    // Auto Read Logic
                    if(isPlaying && document.getElementById('autoRead').checked) {
                        speakText(activeItem.cn, `audio-btn-${activeItem.id}`);
                    }
                }
            }
        }
        function scrollToActive() {
            const active = document.querySelector('.active-line');
            if (active) active.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        function togglePlay() {
            const btnPlay = document.getElementById('btnPlay');
            const btnPause = document.getElementById('btnPause');
            if (isPlaying) {
                clearInterval(simulationInterval);
                window.speechSynthesis.cancel(); // Stop audio on pause
                isPlaying = false;
                btnPlay.classList.remove('hidden'); btnPlay.classList.add('flex');
                btnPause.classList.add('hidden');
            } else {
                isPlaying = true;
                btnPlay.classList.add('hidden');
                btnPause.classList.remove('hidden'); btnPause.classList.add('flex');
                
                // Trigger immediate highlight check for audio start
                highlightCurrentLine();

                simulationInterval = setInterval(() => {
                    currentSimulationTime++;
                    updateTimeDisplay(currentSimulationTime);
                    highlightCurrentLine(); // This triggers audio if needed
                    if(currentSimulationTime % 2 === 0) scrollToActive();
                    if (transcripts.length > 0 && currentSimulationTime > transcripts[transcripts.length-1].seconds + 20) togglePlay();
                }, 1000 / simulationSpeed);
            }
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            transcripts = parseSubtitles(rawSubtitleData);
            analyzeVocabulary(transcripts);
            renderList(transcripts);
            initJumpSelect(transcripts);
            
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = transcripts.filter(t => 
                    t.searchText.includes(term) || t.timeFormatted.includes(term)
                );
                renderList(filtered);
            });

            document.getElementById('btnPlay').addEventListener('click', togglePlay);
            document.getElementById('btnPause').addEventListener('click', togglePlay);
            document.getElementById('btnReset').addEventListener('click', () => {
                if(isPlaying) togglePlay();
                jumpToTime(0);
            });

            const tttBtn = document.getElementById('tttToggle');
            tttBtn.addEventListener('click', () => {
                analysisMode = !analysisMode;
                if (analysisMode) {
                    tttBtn.classList.add('bg-green-900', 'border-green-700', 'ring-2', 'ring-green-500', 'ring-offset-1', 'ring-offset-stone-900');
                    tttBtn.classList.remove('bg-stone-800');
                    document.getElementById('transcriptContainer').classList.add('analysis-mode-active');
                    document.getElementById('analysisLegend').classList.remove('hidden');
                    
                    const term = document.getElementById('searchInput').value.toLowerCase();
                    const currentItems = transcripts.filter(t => t.searchText.includes(term));
                    renderList(currentItems);
                    highlightCurrentLine();
                    scrollToActive();
                    document.getElementById('analysisLegend').scrollIntoView({behavior: 'smooth', block: 'center'});
                } else {
                    tttBtn.classList.remove('bg-green-900', 'border-green-700', 'ring-2', 'ring-green-500', 'ring-offset-1', 'ring-offset-stone-900');
                    tttBtn.classList.add('bg-stone-800');
                    document.getElementById('transcriptContainer').classList.remove('analysis-mode-active');
                    document.getElementById('analysisLegend').classList.add('hidden');
                    
                    const term = document.getElementById('searchInput').value.toLowerCase();
                    renderList(transcripts.filter(t => t.searchText.includes(term)));
                    highlightCurrentLine();
                }
            });

            const modeBtn = document.getElementById('modeToggle');
            let isLightMode = false; // Default is Dark now
            modeBtn.addEventListener('click', () => {
                isLightMode = !isLightMode;
                const body = document.body;
                
                // Toggle Logic
                if(isLightMode) {
                    // Switch to LIGHT
                    body.style.backgroundColor = '#fdfbf7'; 
                    body.style.color = '#44403c';
                    modeBtn.textContent = "üåô Ch·∫ø ƒë·ªô T·ªëi";
                    modeBtn.classList.remove('text-stone-300');
                    modeBtn.classList.add('text-stone-700', 'bg-stone-100');

                    // Global elements styles for Light
                    document.querySelectorAll('.bg-stone-900').forEach(el => el.classList.replace('bg-stone-900', 'bg-white'));
                    document.querySelectorAll('.bg-stone-800').forEach(el => el.classList.replace('bg-stone-800', 'bg-white'));
                    document.querySelectorAll('.text-stone-200').forEach(el => el.classList.replace('text-stone-200', 'text-stone-800'));
                    document.querySelectorAll('.text-stone-400').forEach(el => el.classList.replace('text-stone-400', 'text-stone-500'));
                    
                    // Specific Text Colors
                    const cnEls = document.querySelectorAll('.cn-text');
                    cnEls.forEach(el => el.style.color = '#292524');
                    const vietHanEls = document.querySelectorAll('.viet-han-text');
                    vietHanEls.forEach(el => el.style.color = '#b45309');
                    const vietTransEls = document.querySelectorAll('.viet-trans-text');
                    vietTransEls.forEach(el => el.style.color = '#15803d');
                    const enEls = document.querySelectorAll('.en-text');
                    enEls.forEach(el => el.style.color = '#57534e');
                    
                } else {
                    // Switch to DARK (Default)
                    body.style.backgroundColor = '#1c1917'; 
                    body.style.color = '#e7e5e4';
                    modeBtn.textContent = "‚òÄÔ∏è Ch·∫ø ƒë·ªô S√°ng";
                    modeBtn.classList.add('text-stone-300');
                    modeBtn.classList.remove('text-stone-700', 'bg-stone-100');
                    
                    location.reload(); 
                }
            });
        });
    </script>
    <hr>
    <!-- N√∫t quay v·ªÅ trang ch·ªß -->
    <a href="index.html">‚¨Ö Quay v·ªÅ M·ª•c l·ª•c</a>
    <a href="pham3.html">Xem ti·∫øp Ph·∫©m 3 ‚û°</a>
</body>
</html>
